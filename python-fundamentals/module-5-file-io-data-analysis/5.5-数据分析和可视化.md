# 5.5 æ•°æ®åˆ†æå’Œå¯è§†åŒ–

## æ¦‚è¿°

> **ğŸ¯ å°ç™½ç†è§£**ï¼šä»€ä¹ˆæ˜¯"æ•°æ®åˆ†æ"å’Œ"å¯è§†åŒ–"ï¼Ÿ
>
> æƒ³è±¡ä½ æ˜¯ä¸€ä¸ªå¥¶èŒ¶åº—è€æ¿ï¼š
>
> - **åŸå§‹æ•°æ®**ï¼šæ¯å¤©çš„é”€å”®è®°å½•ï¼ˆæ—¥æœŸã€äº§å“ã€æ•°é‡ã€é‡‘é¢ï¼‰
> - **æ•°æ®åˆ†æ**ï¼šä»è®°å½•ä¸­å‘ç°è§„å¾‹ï¼ˆå‘¨æœ«å–å¾—å¤šã€çç å¥¶èŒ¶æœ€ç«ï¼‰
> - **å¯è§†åŒ–**ï¼šç”»æˆå›¾è¡¨ï¼Œä¸€çœ¼å°±èƒ½çœ‹æ‡‚è¶‹åŠ¿
>
> ```
> åŸå§‹æ•°æ® (Excel/æ•°æ®åº“)
>     â†“ æ•°æ®åˆ†æ (æ‰¾è§„å¾‹)
> æ´å¯Ÿ (çç å¥¶èŒ¶é”€é‡å¢é•¿ 30%)
>     â†“ å¯è§†åŒ– (ç”»å›¾)
> ğŸ“Š å›¾è¡¨ (è€æ¿ä¸€çœ‹å°±æ‡‚)
> ```
>
> **ä¸ºä»€ä¹ˆ Python é€‚åˆåšæ•°æ®åˆ†æï¼Ÿ**
>
> - åº“ä¸°å¯Œï¼šNumPyã€Pandasã€Matplotlib ç­‰
> - ä»£ç å¯å¤ç”¨ï¼šåŒæ ·çš„åˆ†æé€»è¾‘ï¼Œæ¢æ•°æ®å°±èƒ½ç”¨
> - å’Œ AI ç»“åˆï¼šåˆ†æç»“æœå¯ä»¥å–‚ç»™æœºå™¨å­¦ä¹ æ¨¡å‹

æ•°æ®åˆ†æå’Œå¯è§†åŒ–æ˜¯ Python æœ€å¼ºå¤§çš„åº”ç”¨é¢†åŸŸä¹‹ä¸€ã€‚æœ¬èŠ‚ä»‹ç»äº”ä¸ªæ ¸å¿ƒåº“ï¼š

- **NumPy**ï¼šé«˜æ•ˆæ•°å€¼è®¡ç®—
- **Pandas**ï¼šæ•°æ®åˆ†æå’Œå¤„ç†
- **Matplotlib**ï¼šåŸºç¡€ç»‘å›¾åº“
- **Seaborn**ï¼šç»Ÿè®¡å¯è§†åŒ–
- **Plotly**ï¼šäº¤äº’å¼å›¾è¡¨

> **æç¤º**ï¼šè¯·åœ¨æœ¬åœ° Python ç¯å¢ƒä¸­è¿è¡Œä»£ç ã€‚å»ºè®®ä½¿ç”¨ Jupyter Notebook ä»¥ä¾¿ç›´æ¥æŸ¥çœ‹å›¾è¡¨è¾“å‡ºã€‚

---

## NumPyï¼šæ•°å€¼è®¡ç®—åŸºç¡€

> **ğŸ¯ å°ç™½ç†è§£**ï¼šä¸ºä»€ä¹ˆéœ€è¦ NumPyï¼Ÿ
>
> Python è‡ªå¸¦çš„åˆ—è¡¨ `list` å¤„ç†æ•°å­—å¾ˆæ…¢ï¼ŒNumPy çš„æ•°ç»„å¿« 100 å€ï¼
>
> **ç±»æ¯”**ï¼š
>
> - `list`ï¼šä¸€ä¸ªä¸€ä¸ªæ‰‹åŠ¨ç®—ï¼ˆ`for` å¾ªç¯ï¼‰
> - `numpy`ï¼šä¸€æ¬¡æ€§æ‰¹é‡ç®—ï¼ˆå‘é‡åŒ–è¿ç®—ï¼‰
>
> ```python
> # æ™®é€š Python åˆ—è¡¨ï¼ˆæ…¢ï¼‰
> result = []
> for x in [1, 2, 3, 4]:
>     result.append(x * 2)
>
> # NumPy æ•°ç»„ï¼ˆå¿« 100 å€ï¼‰
> import numpy as np
> result = np.array([1, 2, 3, 4]) * 2  # ä¸€è¡Œæå®šï¼
> ```
>
> **æ ¸å¿ƒæ¦‚å¿µ**ï¼š
>
> | æ¦‚å¿µ | è§£é‡Š | ç±»æ¯” |
> |------|------|------|
> | `ndarray` | NumPy çš„æ•°ç»„ç±»å‹ | é«˜æ•ˆç‰ˆçš„ list |
> | `shape` | æ•°ç»„çš„å½¢çŠ¶ (å‡ è¡Œå‡ åˆ—) | çŸ©é˜µçš„å°ºå¯¸ |
> | å‘é‡åŒ–è¿ç®— | ä¸ç”¨å¾ªç¯ï¼Œç›´æ¥å¯¹æ•´ä¸ªæ•°ç»„æ“ä½œ | æ‰¹å¤„ç† vs å•ä¸ªå¤„ç† |

NumPy æ˜¯ç§‘å­¦è®¡ç®—çš„åŸºçŸ³ï¼Œæä¾›é«˜æ€§èƒ½çš„å¤šç»´æ•°ç»„è¿ç®—ã€‚

### æ•°ç»„åˆ›å»ºå’ŒåŸºæœ¬æ“ä½œ

```python
import numpy as np

# åˆ›å»ºæ•°ç»„
arr1 = np.array([1, 2, 3, 4, 5])
arr2 = np.array([[1, 2, 3], [4, 5, 6]])

print("ä¸€ç»´æ•°ç»„:", arr1)
print("äºŒç»´æ•°ç»„:")
print(arr2)
print(f"å½¢çŠ¶: {arr2.shape}, ç»´åº¦: {arr2.ndim}")

# ç‰¹æ®Šæ•°ç»„
zeros = np.zeros((3, 3))
ones = np.ones((2, 4))
eye = np.eye(3)  # å•ä½çŸ©é˜µ

print("\né›¶çŸ©é˜µ:")
print(zeros)
print("\nå•ä½çŸ©é˜µ:")
print(eye)

# æ•°å€¼èŒƒå›´
range_arr = np.arange(0, 10, 2)  # [0, 2, 4, 6, 8]
linspace_arr = np.linspace(0, 1, 5)  # ç­‰é—´è· 5 ä¸ªç‚¹

print(f"\narange: {range_arr}")
print(f"linspace: {linspace_arr}")
```

**è¾“å‡º**ï¼š
```
ä¸€ç»´æ•°ç»„: [1 2 3 4 5]
äºŒç»´æ•°ç»„:
[[1 2 3]
 [4 5 6]]
å½¢çŠ¶: (2, 3), ç»´åº¦: 2

é›¶çŸ©é˜µ:
[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]

å•ä½çŸ©é˜µ:
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]

arange: [0 2 4 6 8]
linspace: [0.   0.25 0.5  0.75 1.  ]
```

### æ•°ç»„è¿ç®—

```python
import numpy as np

# å‘é‡åŒ–è¿ç®—ï¼ˆæ¯” Python å¾ªç¯å¿« 100 å€ï¼‰
a = np.array([1, 2, 3, 4])
b = np.array([10, 20, 30, 40])

print("åŠ æ³•:", a + b)
print("ä¹˜æ³•:", a * b)
print("å¹³æ–¹:", a ** 2)
print("æ±‚å’Œ:", np.sum(a))
print("å‡å€¼:", np.mean(a))
print("æ ‡å‡†å·®:", np.std(a))

# çŸ©é˜µè¿ç®—
matrix_a = np.array([[1, 2], [3, 4]])
matrix_b = np.array([[5, 6], [7, 8]])

print("\nçŸ©é˜µä¹˜æ³•:")
print(np.dot(matrix_a, matrix_b))  # æˆ– matrix_a @ matrix_b

# ç»Ÿè®¡å‡½æ•°
data = np.random.randn(1000)  # 1000 ä¸ªæ ‡å‡†æ­£æ€åˆ†å¸ƒéšæœºæ•°
print(f"\néšæœºæ•°ç»Ÿè®¡:")
print(f"å‡å€¼: {np.mean(data):.4f}")
print(f"æ ‡å‡†å·®: {np.std(data):.4f}")
print(f"æœ€å°å€¼: {np.min(data):.4f}")
print(f"æœ€å¤§å€¼: {np.max(data):.4f}")
```

**è¾“å‡º**ï¼š
```
åŠ æ³•: [11 22 33 44]
ä¹˜æ³•: [ 10  40  90 160]
å¹³æ–¹: [ 1  4  9 16]
æ±‚å’Œ: 10
å‡å€¼: 2.5
æ ‡å‡†å·®: 1.118033988749895

çŸ©é˜µä¹˜æ³•:
[[19 22]
 [43 50]]

éšæœºæ•°ç»Ÿè®¡:
å‡å€¼: 0.0156
æ ‡å‡†å·®: 1.0023
æœ€å°å€¼: -3.2145
æœ€å¤§å€¼: 3.1876
```

---

## Pandasï¼šæ•°æ®åˆ†æåˆ©å™¨

> **ğŸ¯ å°ç™½ç†è§£**ï¼šPandas æ˜¯ä»€ä¹ˆï¼Ÿ
>
> **Pandas = Python ç‰ˆçš„ Excel**ï¼Œä½†æ›´å¼ºå¤§ï¼
>
> | Excel | Pandas | ä¼˜åŠ¿ |
> |-------|--------|------|
> | æ‰‹åŠ¨æ“ä½œ | å†™ä»£ç è‡ªåŠ¨åŒ– | å¯é‡å¤æ‰§è¡Œ |
> | ç™¾ä¸‡è¡Œå°±å¡ | å¤„ç†æ›´å¤§æ•°æ® | æ€§èƒ½æ›´å¥½ |
> | å¤æ‚å…¬å¼éš¾ç»´æŠ¤ | ä»£ç æ¸…æ™°å¯è¯» | æ˜“äºè°ƒè¯• |
>
> **æ ¸å¿ƒæ¦‚å¿µ**ï¼š
>
> - **DataFrame**ï¼šäºŒç»´è¡¨æ ¼ï¼ˆåƒ Excel çš„å·¥ä½œè¡¨ï¼‰
> - **Series**ï¼šä¸€åˆ—æ•°æ®ï¼ˆåƒ Excel çš„ä¸€åˆ—ï¼‰
>
> ```
> DataFrame ç»“æ„ï¼š
>
>      å§“å    å¹´é¾„    åŸå¸‚     è–ªèµ„
> 0    å¼ ä¸‰    25     åŒ—äº¬    15000   â† è¡Œ (row)
> 1    æå››    30     ä¸Šæµ·    20000
> 2    ç‹äº”    35     å¹¿å·    18000
>      â†‘
>     åˆ— (column)
> ```
>
> **å¸¸ç”¨æ“ä½œ**ï¼š
>
> - `df.head()` â†’ çœ‹å‰å‡ è¡Œ
> - `df['åˆ—å']` â†’ é€‰æ‹©ä¸€åˆ—
> - `df[df['å¹´é¾„'] > 28]` â†’ æ¡ä»¶ç­›é€‰
> - `df.groupby('éƒ¨é—¨').mean()` â†’ åˆ†ç»„ç»Ÿè®¡

Pandas æä¾› DataFrame æ•°æ®ç»“æ„ï¼Œæ˜¯æ•°æ®åˆ†æçš„æ ‡å‡†å·¥å…·ã€‚

### åˆ›å»ºå’ŒæŸ¥çœ‹æ•°æ®

```python
import pandas as pd
import numpy as np

# ä»å­—å…¸åˆ›å»º DataFrame
data = {
    'å§“å': ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­', 'é’±ä¸ƒ'],
    'å¹´é¾„': [25, 30, 35, 28, 32],
    'åŸå¸‚': ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æ·±åœ³', 'æ­å·'],
    'è–ªèµ„': [15000, 20000, 18000, 22000, 25000]
}

df = pd.DataFrame(data)

print("DataFrame å†…å®¹:")
print(df)
print(f"\næ•°æ®å½¢çŠ¶: {df.shape}")
print(f"\næ•°æ®ç±»å‹:\n{df.dtypes}")
print(f"\nç»Ÿè®¡æ‘˜è¦:\n{df.describe()}")
```

**è¾“å‡º**ï¼š
```
DataFrame å†…å®¹:
   å§“å  å¹´é¾„  åŸå¸‚    è–ªèµ„
0  å¼ ä¸‰  25  åŒ—äº¬  15000
1  æå››  30  ä¸Šæµ·  20000
2  ç‹äº”  35  å¹¿å·  18000
3  èµµå…­  28  æ·±åœ³  22000
4  é’±ä¸ƒ  32  æ­å·  25000

æ•°æ®å½¢çŠ¶: (5, 4)

æ•°æ®ç±»å‹:
å§“å    object
å¹´é¾„     int64
åŸå¸‚    object
è–ªèµ„     int64
dtype: object

ç»Ÿè®¡æ‘˜è¦:
              å¹´é¾„           è–ªèµ„
count   5.000000      5.000000
mean   30.000000  20000.000000
std     3.807887   3807.886553
min    25.000000  15000.000000
25%    28.000000  18000.000000
50%    30.000000  20000.000000
75%    32.000000  22000.000000
max    35.000000  25000.000000
```

### æ•°æ®ç­›é€‰å’Œæ“ä½œ

```python
import pandas as pd

# åˆ›å»ºç¤ºä¾‹æ•°æ®
data = {
    'å§“å': ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­', 'é’±ä¸ƒ'],
    'å¹´é¾„': [25, 30, 35, 28, 32],
    'éƒ¨é—¨': ['æŠ€æœ¯', 'é”€å”®', 'æŠ€æœ¯', 'é”€å”®', 'æŠ€æœ¯'],
    'è–ªèµ„': [15000, 20000, 18000, 22000, 25000]
}
df = pd.DataFrame(data)

# é€‰æ‹©åˆ—
print("é€‰æ‹©å•åˆ—:")
print(df['å§“å'])

print("\né€‰æ‹©å¤šåˆ—:")
print(df[['å§“å', 'è–ªèµ„']])

# æ¡ä»¶ç­›é€‰
print("\nå¹´é¾„å¤§äº 28 çš„å‘˜å·¥:")
print(df[df['å¹´é¾„'] > 28])

print("\næŠ€æœ¯éƒ¨é—¨çš„å‘˜å·¥:")
print(df[df['éƒ¨é—¨'] == 'æŠ€æœ¯'])

# å¤šæ¡ä»¶ç­›é€‰
print("\næŠ€æœ¯éƒ¨é—¨ä¸”è–ªèµ„å¤§äº 17000:")
print(df[(df['éƒ¨é—¨'] == 'æŠ€æœ¯') & (df['è–ªèµ„'] > 17000)])

# æ·»åŠ æ–°åˆ—
df['å¹´è–ª'] = df['è–ªèµ„'] * 12
print("\næ·»åŠ å¹´è–ªåˆ—:")
print(df)

# åˆ†ç»„ç»Ÿè®¡
print("\næŒ‰éƒ¨é—¨ç»Ÿè®¡å¹³å‡è–ªèµ„:")
print(df.groupby('éƒ¨é—¨')['è–ªèµ„'].mean())
```

### è¯»å†™æ–‡ä»¶

```python
import pandas as pd

# åˆ›å»ºç¤ºä¾‹æ•°æ®å¹¶ä¿å­˜
data = {
    'äº§å“': ['æ‰‹æœº', 'ç”µè„‘', 'å¹³æ¿', 'è€³æœº'],
    'é”€é‡': [1000, 500, 800, 1500],
    'å•ä»·': [5000, 8000, 3000, 500]
}
df = pd.DataFrame(data)

# ä¿å­˜ä¸º CSV
df.to_csv('sales_data.csv', index=False, encoding='utf-8')
print("å·²ä¿å­˜ä¸º sales_data.csv")

# è¯»å– CSV
df_loaded = pd.read_csv('sales_data.csv', encoding='utf-8')
print("\nè¯»å–çš„æ•°æ®:")
print(df_loaded)

# ä¿å­˜ä¸º JSON
df.to_json('sales_data.json', orient='records', force_ascii=False, indent=2)
print("\nå·²ä¿å­˜ä¸º sales_data.json")
```

---

## Matplotlibï¼šåŸºç¡€ç»‘å›¾

> **ğŸ¯ å°ç™½ç†è§£**ï¼šMatplotlib æ˜¯ä»€ä¹ˆï¼Ÿ
>
> **Matplotlib = Python çš„ç”»å›¾å·¥å…·**ï¼Œå¯ä»¥ç”»å„ç§ç»Ÿè®¡å›¾è¡¨ã€‚
>
> **å¸¸è§å›¾è¡¨ç±»å‹**ï¼š
>
> | å›¾è¡¨ | ç”¨é€” | é€‚åˆåœºæ™¯ |
> |------|------|---------|
> | æŠ˜çº¿å›¾ | å±•ç¤ºè¶‹åŠ¿å˜åŒ– | è‚¡ç¥¨èµ°åŠ¿ã€é”€å”®è¶‹åŠ¿ |
> | æŸ±çŠ¶å›¾ | å¯¹æ¯”å¤§å° | å„éƒ¨é—¨ä¸šç»©å¯¹æ¯” |
> | é¥¼å›¾ | å±•ç¤ºå æ¯” | å¸‚åœºä»½é¢åˆ†å¸ƒ |
> | æ•£ç‚¹å›¾ | çœ‹å˜é‡å…³ç³» | èº«é«˜ vs ä½“é‡ |
>
> **åŸºæœ¬å¥—è·¯ï¼ˆè®°ä½è¿™ä¸ªæ¨¡å¼ï¼‰**ï¼š
>
> ```python
> import matplotlib.pyplot as plt
>
> # 1. åˆ›å»ºç”»å¸ƒ
> plt.figure(figsize=(10, 6))
>
> # 2. ç”»å›¾
> plt.plot(x, y)  # æŠ˜çº¿å›¾
> # plt.bar(x, y)  # æŸ±çŠ¶å›¾
> # plt.pie(sizes)  # é¥¼å›¾
>
> # 3. æ·»åŠ æ ‡é¢˜å’Œæ ‡ç­¾
> plt.title('æ ‡é¢˜')
> plt.xlabel('Xè½´')
> plt.ylabel('Yè½´')
>
> # 4. ä¿å­˜/æ˜¾ç¤º
> plt.savefig('å›¾ç‰‡.png')
> plt.show()
> ```

Matplotlib æ˜¯ Python æœ€åŸºç¡€çš„ç»‘å›¾åº“ï¼ŒåŠŸèƒ½å¼ºå¤§ä¸”çµæ´»ã€‚

### æŠ˜çº¿å›¾

```python
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import numpy as np

# æ•°æ®
months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
sales_a = [120, 135, 150, 145, 160, 180]
sales_b = [100, 115, 125, 140, 135, 155]

# åˆ›å»ºå›¾å½¢
plt.figure(figsize=(10, 6))
plt.plot(months, sales_a, marker='o', linewidth=2, label='Product A')
plt.plot(months, sales_b, marker='s', linewidth=2, label='Product B')

plt.title('2024 H1 Sales Trend', fontsize=16)
plt.xlabel('Month', fontsize=12)
plt.ylabel('Sales (10K CNY)', fontsize=12)
plt.legend()
plt.grid(True, linestyle='--', alpha=0.7)

plt.tight_layout()
plt.savefig('line_chart.png', dpi=150)
plt.show()

```

**è¾“å‡ºå›¾è¡¨**ï¼šæ˜¾ç¤ºä¸¤æ¡æŠ˜çº¿åˆ†åˆ«ä»£è¡¨äº§å“Aå’Œäº§å“Bçš„é”€å”®è¶‹åŠ¿ã€‚

### æŸ±çŠ¶å›¾

```python
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import numpy as np

# æ•°æ®
categories = ['Beijing', 'Shanghai', 'Guangzhou', 'Shenzhen', 'Hangzhou']
values_2023 = [85, 92, 78, 88, 70]
values_2024 = [95, 98, 85, 95, 82]

x = np.arange(len(categories))
width = 0.35

# åˆ›å»ºå›¾å½¢
fig, ax = plt.subplots(figsize=(10, 6))
bars1 = ax.bar(x - width/2, values_2023, width, label='2023', color='steelblue')
bars2 = ax.bar(x + width/2, values_2024, width, label='2024', color='coral')

ax.set_title('City Sales Comparison', fontsize=16)
ax.set_xlabel('City', fontsize=12)
ax.set_ylabel('Sales (100M CNY)', fontsize=12)
ax.set_xticks(x)
ax.set_xticklabels(categories)
ax.legend()

# æ·»åŠ æ•°å€¼æ ‡ç­¾
for bar in bars1:
    height = bar.get_height()
    ax.annotate(f'{height}',
                xy=(bar.get_x() + bar.get_width() / 2, height),
                xytext=(0, 3),
                textcoords="offset points",
                ha='center', va='bottom', fontsize=9)

for bar in bars2:
    height = bar.get_height()
    ax.annotate(f'{height}',
                xy=(bar.get_x() + bar.get_width() / 2, height),
                xytext=(0, 3),
                textcoords="offset points",
                ha='center', va='bottom', fontsize=9)

plt.tight_layout()
plt.savefig('bar_chart.png', dpi=150)
plt.show()
```

### é¥¼å›¾

```python
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt

# æ•°æ®
labels = ['Tech', 'Sales', 'Marketing', 'HR', 'Finance']
sizes = [35, 25, 20, 12, 8]
colors = ['#ff9999', '#66b3ff', '#99ff99', '#ffcc99', '#ff99cc']
explode = (0.05, 0, 0, 0, 0)  # Highlight first slice

# åˆ›å»ºå›¾å½¢
fig, ax = plt.subplots(figsize=(8, 8))
wedges, texts, autotexts = ax.pie(
    sizes,
    explode=explode,
    labels=labels,
    colors=colors,
    autopct='%1.1f%%',
    shadow=True,
    startangle=90
)

ax.set_title('Department Staff Distribution', fontsize=16)
plt.setp(autotexts, size=11, weight='bold')

plt.tight_layout()
plt.savefig('pie_chart.png', dpi=150)
plt.show()

```

### æ•£ç‚¹å›¾

```python
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import numpy as np

# ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
np.random.seed(42)
n = 100
x = np.random.randn(n) * 10 + 50  # Work experience (months)
y = x * 200 + np.random.randn(n) * 2000 + 5000  # Salary

# åˆ›å»ºå›¾å½¢
plt.figure(figsize=(10, 6))
scatter = plt.scatter(x, y, c=y, cmap='viridis', alpha=0.7, s=60)
plt.colorbar(scatter, label='Salary Level')

# æ·»åŠ è¶‹åŠ¿çº¿
z = np.polyfit(x, y, 1)
p = np.poly1d(z)
plt.plot(x, p(x), "r--", linewidth=2, label=f'Trend: y={z[0]:.1f}x+{z[1]:.1f}')

plt.title('Work Experience vs Salary', fontsize=16)
plt.xlabel('Experience (months)', fontsize=12)
plt.ylabel('Monthly Salary (CNY)', fontsize=12)
plt.legend()
plt.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('scatter_chart.png', dpi=150)
plt.show()

```

### å­å›¾å¸ƒå±€

```python
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import numpy as np

# å‡†å¤‡æ•°æ®
np.random.seed(42)
x = np.linspace(0, 10, 100)

# åˆ›å»º 2x2 å­å›¾
fig, axes = plt.subplots(2, 2, figsize=(12, 10))

# å­å›¾1: æ­£å¼¦æ³¢
axes[0, 0].plot(x, np.sin(x), 'b-', linewidth=2)
axes[0, 0].set_title('Sine Function')
axes[0, 0].set_xlabel('x')
axes[0, 0].set_ylabel('sin(x)')
axes[0, 0].grid(True, alpha=0.3)

# å­å›¾2: ç›´æ–¹å›¾
data = np.random.randn(1000)
axes[0, 1].hist(data, bins=30, color='green', alpha=0.7, edgecolor='black')
axes[0, 1].set_title('Normal Distribution Histogram')
axes[0, 1].set_xlabel('Value')
axes[0, 1].set_ylabel('Frequency')

# å­å›¾3: æŸ±çŠ¶å›¾
categories = ['A', 'B', 'C', 'D', 'E']
values = [23, 45, 56, 78, 32]
axes[1, 0].bar(categories, values, color='coral')
axes[1, 0].set_title('Category Data')
axes[1, 0].set_xlabel('Category')
axes[1, 0].set_ylabel('Value')

# å­å›¾4: ç®±çº¿å›¾
data_box = [np.random.randn(100) + i for i in range(4)]
axes[1, 1].boxplot(data_box, labels=['Group1', 'Group2', 'Group3', 'Group4'])
axes[1, 1].set_title('Box Plot Comparison')
axes[1, 1].set_ylabel('Value')

plt.suptitle('Matplotlib Subplots Example', fontsize=16, y=1.02)
plt.tight_layout()
plt.savefig('subplot_chart.png', dpi=150)
plt.show()

```

---

## Seabornï¼šç»Ÿè®¡å¯è§†åŒ–

> **ğŸ¯ å°ç™½ç†è§£**ï¼šSeaborn å’Œ Matplotlib æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
>
> **Matplotlib æ˜¯"åŸºç¡€æ¬¾"ï¼ŒSeaborn æ˜¯"é«˜çº§æ¬¾"**ï¼š
>
> | ç‰¹æ€§ | Matplotlib | Seaborn |
> |------|------------|---------|
> | ç¾è§‚åº¦ | éœ€è¦æ‰‹åŠ¨è°ƒæ•´ | é»˜è®¤å°±å¥½çœ‹ |
> | ä»£ç é‡ | è¾ƒå¤š | è¾ƒå°‘ |
> | ç»Ÿè®¡åŠŸèƒ½ | éœ€è¦è‡ªå·±ç®— | å†…ç½®ç»Ÿè®¡ |
> | é€‚åˆåœºæ™¯ | ç²¾ç»†æ§åˆ¶ | å¿«é€Ÿæ¢ç´¢ |
>
> **ä¾‹å­å¯¹æ¯”**ï¼š
>
> ```python
> # Matplotlibï¼ˆ10+ è¡Œä»£ç ï¼‰
> plt.figure()
> plt.scatter(x, y)
> plt.xlabel('X')
> plt.ylabel('Y')
> # ... è¿˜è¦åŠ è¶‹åŠ¿çº¿ã€é¢œè‰²ç­‰
>
> # Seabornï¼ˆ1 è¡Œä»£ç ï¼‰
> sns.regplot(x='X', y='Y', data=df)  # è‡ªå¸¦è¶‹åŠ¿çº¿ï¼
> ```
>
> **å¸¸ç”¨ Seaborn å›¾è¡¨**ï¼š
>
> - `histplot` â†’ ç›´æ–¹å›¾ï¼ˆçœ‹åˆ†å¸ƒï¼‰
> - `boxplot` â†’ ç®±çº¿å›¾ï¼ˆçœ‹ç¦»ç¾¤å€¼ï¼‰
> - `heatmap` â†’ çƒ­åŠ›å›¾ï¼ˆçœ‹ç›¸å…³æ€§ï¼‰
> - `pairplot` â†’ å˜é‡å…³ç³»çŸ©é˜µ

Seaborn åŸºäº Matplotlibï¼Œæä¾›æ›´ç¾è§‚çš„ç»Ÿè®¡å›¾è¡¨å’Œæ›´ç®€æ´çš„ APIã€‚

### åˆ†å¸ƒå›¾

```python
import seaborn as sns
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

sns.set_style("whitegrid")

# ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
np.random.seed(42)
data = pd.DataFrame({
    'Age': np.random.normal(35, 10, 500).astype(int),
    'Income': np.random.normal(50000, 15000, 500),
    'Gender': np.random.choice(['Male', 'Female'], 500)
})

# åˆ›å»º 1x2 å­å›¾
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# ç›´æ–¹å›¾ + æ ¸å¯†åº¦ä¼°è®¡
sns.histplot(data=data, x='Age', kde=True, ax=axes[0], color='steelblue')
axes[0].set_title('Age Distribution', fontsize=14)

# åˆ†ç»„ç›´æ–¹å›¾
sns.histplot(data=data, x='Income', hue='Gender', kde=True, ax=axes[1])
axes[1].set_title('Income Distribution by Gender', fontsize=14)

plt.tight_layout()
plt.savefig('seaborn_dist.png', dpi=150)
plt.show()

```

### å…³ç³»å›¾

```python
import seaborn as sns
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

sns.set_style("whitegrid")

# ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
np.random.seed(42)
n = 200
data = pd.DataFrame({
    'AdSpend': np.random.uniform(10, 100, n),
    'Revenue': None,
    'Region': np.random.choice(['East', 'South', 'North', 'West'], n)
})
data['Revenue'] = data['AdSpend'] * 2.5 + np.random.normal(0, 20, n) + 50

# åˆ›å»ºå…³ç³»å›¾
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# æ•£ç‚¹å›¾ + å›å½’çº¿
sns.regplot(data=data, x='AdSpend', y='Revenue', ax=axes[0],
            scatter_kws={'alpha': 0.5}, line_kws={'color': 'red'})
axes[0].set_title('Ad Spend vs Revenue (with Regression)', fontsize=14)

# æŒ‰ç±»åˆ«ç€è‰²çš„æ•£ç‚¹å›¾
sns.scatterplot(data=data, x='AdSpend', y='Revenue', hue='Region',
                style='Region', s=80, ax=axes[1])
axes[1].set_title('Ad Spend vs Revenue by Region', fontsize=14)

plt.tight_layout()
plt.savefig('seaborn_relation.png', dpi=150)
plt.show()

```

### åˆ†ç±»å›¾

```python
import seaborn as sns
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

sns.set_style("whitegrid")

# ç”Ÿæˆæ¨¡æ‹Ÿå‘˜å·¥æ•°æ®
np.random.seed(42)
data = pd.DataFrame({
    'Dept': np.repeat(['Tech', 'Sales', 'Marketing', 'HR'], 50),
    'Salary': np.concatenate([
        np.random.normal(18000, 3000, 50),
        np.random.normal(15000, 4000, 50),
        np.random.normal(14000, 2500, 50),
        np.random.normal(12000, 2000, 50)
    ]),
    'YearsExp': np.random.randint(1, 10, 200)
})

# åˆ›å»º 2x2 å­å›¾
fig, axes = plt.subplots(2, 2, figsize=(14, 12))

# ç®±çº¿å›¾
sns.boxplot(data=data, x='Dept', y='Salary', ax=axes[0, 0], palette='Set2')
axes[0, 0].set_title('Salary by Department (Box Plot)', fontsize=14)

# å°æç´å›¾
sns.violinplot(data=data, x='Dept', y='Salary', ax=axes[0, 1], palette='Set3')
axes[0, 1].set_title('Salary by Department (Violin Plot)', fontsize=14)

# å¸¦æ•£ç‚¹çš„ç®±çº¿å›¾
sns.boxplot(data=data, x='Dept', y='Salary', ax=axes[1, 0], palette='pastel')
sns.stripplot(data=data, x='Dept', y='Salary', ax=axes[1, 0],
              color='black', alpha=0.3, size=3)
axes[1, 0].set_title('Salary Distribution (with Points)', fontsize=14)

# æ¡å½¢å›¾ï¼ˆæ˜¾ç¤ºå‡å€¼å’Œç½®ä¿¡åŒºé—´ï¼‰
sns.barplot(data=data, x='Dept', y='Salary', ax=axes[1, 1],
            palette='coolwarm', errorbar='ci')
axes[1, 1].set_title('Average Salary by Department', fontsize=14)

plt.tight_layout()
plt.savefig('seaborn_category.png', dpi=150)
plt.show()

```

### çƒ­åŠ›å›¾

```python
import seaborn as sns
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

# åˆ›å»ºç›¸å…³çŸ©é˜µæ•°æ®
np.random.seed(42)
n = 200
data = pd.DataFrame({
    'Age': np.random.randint(22, 60, n),
    'YearsExp': np.random.randint(0, 30, n),
    'EduLevel': np.random.randint(1, 5, n),
    'PerfScore': np.random.uniform(60, 100, n),
    'Salary': np.random.normal(15000, 5000, n)
})

# è®¡ç®—ç›¸å…³ç³»æ•°
correlation = data.corr()

# åˆ›å»ºçƒ­åŠ›å›¾
plt.figure(figsize=(10, 8))
sns.heatmap(correlation,
            annot=True,  # æ˜¾ç¤ºæ•°å€¼
            fmt='.2f',   # ä¿ç•™ä¸¤ä½å°æ•°
            cmap='coolwarm',  # é¢œè‰²æ–¹æ¡ˆ
            center=0,    # é¢œè‰²ä¸­å¿ƒç‚¹
            square=True, # æ­£æ–¹å½¢å•å…ƒæ ¼
            linewidths=0.5)

plt.title('Variable Correlation Heatmap', fontsize=16)
plt.tight_layout()
plt.savefig('seaborn_heatmap.png', dpi=150)
plt.show()

```

### æˆå¯¹å…³ç³»å›¾

```python
import seaborn as sns
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

# åˆ›å»ºæ•°æ®
np.random.seed(42)
n = 150
species = np.repeat(['TypeA', 'TypeB', 'TypeC'], 50)
data = pd.DataFrame({
    'Feature1': np.concatenate([
        np.random.normal(5, 1, 50),
        np.random.normal(7, 1.2, 50),
        np.random.normal(6, 0.8, 50)
    ]),
    'Feature2': np.concatenate([
        np.random.normal(3, 0.5, 50),
        np.random.normal(4, 0.8, 50),
        np.random.normal(5, 0.6, 50)
    ]),
    'Feature3': np.concatenate([
        np.random.normal(1.5, 0.3, 50),
        np.random.normal(4, 0.5, 50),
        np.random.normal(5.5, 0.4, 50)
    ]),
    'Category': species
})

# åˆ›å»ºæˆå¯¹å…³ç³»å›¾
pairplot = sns.pairplot(data, hue='Category', palette='husl',
                        diag_kind='kde', plot_kws={'alpha': 0.6})
pairplot.fig.suptitle('Multi-variable Pair Plot', y=1.02, fontsize=16)

plt.savefig('seaborn_pairplot.png', dpi=150)
plt.show()

```

---

## Plotlyï¼šäº¤äº’å¼å¯è§†åŒ–

> **ğŸ¯ å°ç™½ç†è§£**ï¼šä»€ä¹ˆæ˜¯"äº¤äº’å¼"å›¾è¡¨ï¼Ÿ
>
> **æ™®é€šå›¾è¡¨ vs äº¤äº’å¼å›¾è¡¨**ï¼š
>
> | æ™®é€šå›¾è¡¨ (Matplotlib) | äº¤äº’å¼å›¾è¡¨ (Plotly) |
> |----------------------|---------------------|
> | é™æ€å›¾ç‰‡ï¼Œä¸èƒ½åŠ¨ | å¯ä»¥ç¼©æ”¾ã€æ‹–åŠ¨ |
> | åªèƒ½çœ‹å›ºå®šè§†è§’ | é¼ æ ‡æ‚¬åœæ˜¾ç¤ºè¯¦æƒ… |
> | ä¿å­˜ä¸º PNG/PDF | ä¿å­˜ä¸º HTMLï¼ˆç½‘é¡µï¼‰ |
> | é€‚åˆæ‰“å°æŠ¥å‘Š | é€‚åˆç½‘é¡µå±•ç¤º |
>
> **äº¤äº’å¼å›¾è¡¨èƒ½åšä»€ä¹ˆï¼Ÿ**
>
> 1. **ç¼©æ”¾**ï¼šçœ‹ç»†èŠ‚æ—¶æ”¾å¤§ï¼Œçœ‹å…¨å±€æ—¶ç¼©å°
> 2. **æ‚¬åœ**ï¼šé¼ æ ‡æ”¾ä¸Šå»ï¼Œæ˜¾ç¤ºå…·ä½“æ•°å€¼
> 3. **ç­›é€‰**ï¼šç‚¹å‡»å›¾ä¾‹ï¼Œéšè—/æ˜¾ç¤ºæŸç±»æ•°æ®
> 4. **3D æ—‹è½¬**ï¼šæ¢è§’åº¦è§‚å¯Ÿç«‹ä½“å›¾è¡¨
>
> **ä»€ä¹ˆæ—¶å€™ç”¨ Plotlyï¼Ÿ**
>
> - åš Dashboardï¼ˆæ•°æ®çœ‹æ¿ï¼‰
> - éœ€è¦è®©ç”¨æˆ·è‡ªå·±æ¢ç´¢æ•°æ®
> - åœ¨ç½‘é¡µä¸­å±•ç¤ºå›¾è¡¨

Plotly åˆ›å»ºå¯äº¤äº’çš„åŠ¨æ€å›¾è¡¨ï¼Œæ”¯æŒç¼©æ”¾ã€æ‚¬åœæç¤ºç­‰åŠŸèƒ½ã€‚

### åŸºç¡€æŠ˜çº¿å›¾

```python
import plotly.express as px
import pandas as pd
import numpy as np

# å‡†å¤‡æ•°æ®
np.random.seed(42)
months = pd.date_range('2024-01-01', periods=12, freq='M')
data = pd.DataFrame({
    'Date': months,
    'Sales': np.cumsum(np.random.randint(80, 150, 12)) + 1000,
    'Profit': np.cumsum(np.random.randint(20, 50, 12)) + 200
})

# åˆ›å»ºæŠ˜çº¿å›¾
fig = px.line(data, x='Date', y=['Sales', 'Profit'],
              title='2024 Monthly Sales Trend',
              labels={'value': 'Amount (10K CNY)', 'variable': 'Metric'})

fig.update_layout(
    hovermode='x unified',
    legend=dict(orientation='h', yanchor='bottom', y=1.02)
)

# ä¿å­˜ä¸º HTMLï¼ˆå¯äº¤äº’ï¼‰
fig.write_html('plotly_line.html')
# ä¹Ÿå¯ä»¥ä¿å­˜ä¸ºé™æ€å›¾ç‰‡
# fig.write_image('plotly_line.png')
fig.show()

```

### äº¤äº’å¼æ•£ç‚¹å›¾

```python
import plotly.express as px
import pandas as pd
import numpy as np

# ç”Ÿæˆæ•°æ®
np.random.seed(42)
n = 100
data = pd.DataFrame({
    'AdSpend': np.random.uniform(10, 100, n),
    'Revenue': None,
    'Category': np.random.choice(['Electronics', 'Clothing', 'Food', 'Home'], n),
    'Customers': np.random.randint(100, 1000, n)
})
data['Revenue'] = data['AdSpend'] * 3 + np.random.normal(0, 15, n) + 50

# åˆ›å»ºæ•£ç‚¹å›¾
fig = px.scatter(
    data,
    x='AdSpend',
    y='Revenue',
    color='Category',
    size='Customers',
    hover_data=['Customers'],
    title='Ad Spend vs Revenue',
    labels={'AdSpend': 'Ad Spend (10K CNY)', 'Revenue': 'Revenue (10K CNY)'}
)

fig.update_layout(
    legend=dict(orientation='h', yanchor='bottom', y=1.02)
)

fig.write_html('plotly_scatter.html')
fig.show()

```

### äº¤äº’å¼æŸ±çŠ¶å›¾

```python
import plotly.express as px
import pandas as pd
import numpy as np

# å‡†å¤‡æ•°æ®
data = pd.DataFrame({
    'Quarter': ['Q1', 'Q2', 'Q3', 'Q4'] * 3,
    'Region': ['East'] * 4 + ['South'] * 4 + ['North'] * 4,
    'Sales': [120, 135, 128, 145, 98, 112, 105, 125, 85, 95, 92, 108]
})

# åˆ›å»ºåˆ†ç»„æŸ±çŠ¶å›¾
fig = px.bar(
    data,
    x='Quarter',
    y='Sales',
    color='Region',
    barmode='group',
    title='Regional Quarterly Sales Comparison',
    labels={'Sales': 'Sales (10K CNY)'},
    text='Sales'
)

fig.update_traces(textposition='outside')
fig.update_layout(uniformtext_minsize=8, uniformtext_mode='hide')

fig.write_html('plotly_bar.html')
fig.show()

```

### é¥¼å›¾å’Œç¯å½¢å›¾

```python
import plotly.express as px
import plotly.graph_objects as go
from plotly.subplots import make_subplots
import pandas as pd

# å‡†å¤‡æ•°æ®
data = pd.DataFrame({
    'Dept': ['Tech', 'Sales', 'Marketing', 'Operations', 'HR'],
    'Ratio': [35, 25, 18, 15, 7]
})

# åˆ›å»ºå­å›¾ï¼šé¥¼å›¾å’Œç¯å½¢å›¾
fig = make_subplots(rows=1, cols=2,
                    specs=[[{'type': 'pie'}, {'type': 'pie'}]],
                    subplot_titles=['Pie Chart', 'Donut Chart'])

# é¥¼å›¾
fig.add_trace(
    go.Pie(labels=data['Dept'], values=data['Ratio'], name='Pie'),
    row=1, col=1
)

# ç¯å½¢å›¾
fig.add_trace(
    go.Pie(labels=data['Dept'], values=data['Ratio'], hole=0.4, name='Donut'),
    row=1, col=2
)

fig.update_layout(title_text='Staff Distribution by Department', showlegend=True)

fig.write_html('plotly_pie.html')
fig.show()

```

### çƒ­åŠ›å›¾

```python
import plotly.express as px
import pandas as pd
import numpy as np

# ç”Ÿæˆé”€å”®æ•°æ®çŸ©é˜µ
np.random.seed(42)
products = ['Product A', 'Product B', 'Product C', 'Product D', 'Product E']
months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']

sales_matrix = np.random.randint(50, 200, (len(products), len(months)))

# åˆ›å»º DataFrame
data = pd.DataFrame(sales_matrix, index=products, columns=months)

# åˆ›å»ºçƒ­åŠ›å›¾
fig = px.imshow(
    data,
    labels=dict(x='Month', y='Product', color='Sales'),
    title='Product Monthly Sales Heatmap',
    color_continuous_scale='RdYlGn',
    text_auto=True
)

fig.update_layout(
    xaxis_title='Month',
    yaxis_title='Product'
)

fig.write_html('plotly_heatmap.html')
fig.show()
```

### 3D æ•£ç‚¹å›¾

```python
import plotly.express as px
import pandas as pd
import numpy as np

# ç”Ÿæˆ 3D æ•°æ®
np.random.seed(42)
n = 200
data = pd.DataFrame({
    'X': np.random.randn(n),
    'Y': np.random.randn(n),
    'Z': np.random.randn(n),
    'Category': np.random.choice(['A', 'B', 'C'], n)
})

# åˆ›å»º 3D æ•£ç‚¹å›¾
fig = px.scatter_3d(
    data,
    x='X', y='Y', z='Z',
    color='Category',
    title='3D Data Distribution',
    opacity=0.7
)

fig.update_layout(
    scene=dict(
        xaxis_title='X Axis',
        yaxis_title='Y Axis',
        zaxis_title='Z Axis'
    )
)

fig.write_html('plotly_3d.html')
fig.show()
```

---

## ç»¼åˆæ¡ˆä¾‹ï¼šé”€å”®æ•°æ®åˆ†ææŠ¥å‘Š

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åˆ†æå’Œå¯è§†åŒ–æ¡ˆä¾‹ï¼š

```python
import numpy as np
import pandas as pd
import matplotlib
# matplotlib.use('Agg') # å¦‚æœåœ¨æ— å›¾å½¢ç•Œé¢çš„ç¯å¢ƒè¿è¡Œï¼Œè¯·å–æ¶ˆæ³¨é‡Š
import matplotlib.pyplot as plt
import seaborn as sns

sns.set_style("whitegrid")

# 1. ç”Ÿæˆæ¨¡æ‹Ÿé”€å”®æ•°æ®
np.random.seed(42)
n = 500

data = pd.DataFrame({
    'OrderID': range(1, n + 1),
    'Date': pd.date_range('2024-01-01', periods=n, freq='D')[:n],
    'Category': np.random.choice(['Electronics', 'Clothing', 'Food', 'Home'], n),
    'Channel': np.random.choice(['Online', 'Offline'], n, p=[0.6, 0.4]),
    'Revenue': np.random.exponential(500, n) + 100,
    'Quantity': np.random.randint(1, 10, n),
    'Rating': np.random.uniform(3.0, 5.0, n)
})

# æ·»åŠ æœˆä»½åˆ—
data['Month'] = data['Date'].dt.to_period('M').astype(str)

print("Data Preview:")
print(data.head(10))
print(f"\nDataset Size: {data.shape}")

# 2. æ•°æ®ç»Ÿè®¡åˆ†æ
print("\n" + "=" * 50)
print("Statistical Analysis")
print("=" * 50)

print("\nBasic Statistics:")
print(data.describe())

print("\nBy Category:")
category_stats = data.groupby('Category').agg({
    'Revenue': ['sum', 'mean', 'count'],
    'Rating': 'mean'
}).round(2)
print(category_stats)

print("\nBy Channel:")
channel_stats = data.groupby('Channel').agg({
    'Revenue': ['sum', 'mean'],
    'Quantity': 'sum'
}).round(2)
print(channel_stats)

# 3. å¯è§†åŒ–åˆ†æ
fig, axes = plt.subplots(2, 3, figsize=(18, 12))

# å›¾1: æœˆåº¦é”€å”®è¶‹åŠ¿
monthly_sales = data.groupby('Month')['Revenue'].sum().reset_index()
axes[0, 0].plot(monthly_sales['Month'], monthly_sales['Revenue'],
                marker='o', linewidth=2, color='steelblue')
axes[0, 0].set_title('Monthly Sales Trend', fontsize=14)
axes[0, 0].set_xlabel('Month')
axes[0, 0].set_ylabel('Revenue (CNY)')
axes[0, 0].tick_params(axis='x', rotation=45)

# å›¾2: äº§å“ç±»åˆ«é”€å”®å æ¯”
category_sales = data.groupby('Category')['Revenue'].sum()
colors = ['#ff9999', '#66b3ff', '#99ff99', '#ffcc99']
axes[0, 1].pie(category_sales, labels=category_sales.index, autopct='%1.1f%%',
               colors=colors, startangle=90)
axes[0, 1].set_title('Revenue by Category', fontsize=14)

# å›¾3: é”€å”®æ¸ é“å¯¹æ¯”
channel_sales = data.groupby('Channel')['Revenue'].sum()
axes[0, 2].bar(channel_sales.index, channel_sales.values,
               color=['coral', 'steelblue'])
axes[0, 2].set_title('Revenue by Channel', fontsize=14)
axes[0, 2].set_ylabel('Revenue (CNY)')
for i, v in enumerate(channel_sales.values):
    axes[0, 2].text(i, v + 1000, f'{v:,.0f}', ha='center')

# å›¾4: é”€å”®é¢åˆ†å¸ƒ
sns.histplot(data=data, x='Revenue', kde=True, ax=axes[1, 0], color='steelblue')
axes[1, 0].set_title('Revenue Distribution', fontsize=14)
axes[1, 0].set_xlabel('Revenue (CNY)')

# å›¾5: å„ç±»åˆ«å®¢æˆ·è¯„åˆ†ç®±çº¿å›¾
sns.boxplot(data=data, x='Category', y='Rating', ax=axes[1, 1], palette='Set2')
axes[1, 1].set_title('Rating by Category', fontsize=14)
axes[1, 1].tick_params(axis='x', rotation=15)

# å›¾6: é”€å”®é¢ä¸æ•°é‡å…³ç³»
sns.scatterplot(data=data, x='Quantity', y='Revenue', hue='Channel',
                ax=axes[1, 2], alpha=0.6)
axes[1, 2].set_title('Revenue vs Quantity', fontsize=14)
axes[1, 2].set_xlabel('Quantity')
axes[1, 2].set_ylabel('Revenue (CNY)')

plt.suptitle('Sales Data Analysis Report', fontsize=18, y=1.02)
plt.tight_layout()
plt.savefig('sales_analysis_report.png', dpi=150, bbox_inches='tight')
plt.show()
```

---

## å®‰è£…æŒ‡å—

```bash
# ä½¿ç”¨ pip å®‰è£…
pip install numpy pandas matplotlib seaborn plotly

# ä½¿ç”¨ conda å®‰è£…
conda install numpy pandas matplotlib seaborn plotly

# Jupyter Notebook ä¸­æ˜¾ç¤º Plotly å›¾è¡¨
pip install nbformat
```

---

## å°ç»“

æœ¬èŠ‚ä»‹ç»äº† Python æ•°æ®åˆ†æå’Œå¯è§†åŒ–çš„äº”å¤§æ ¸å¿ƒåº“ï¼š

| åº“ | ç”¨é€” | ç‰¹ç‚¹ |
|---|---|---|
| **NumPy** | æ•°å€¼è®¡ç®— | é«˜æ•ˆæ•°ç»„è¿ç®—ï¼Œç§‘å­¦è®¡ç®—åŸºç¡€ |
| **Pandas** | æ•°æ®åˆ†æ | DataFrame ç»“æ„ï¼Œæ•°æ®å¤„ç†åˆ©å™¨ |
| **Matplotlib** | åŸºç¡€ç»‘å›¾ | åŠŸèƒ½å…¨é¢ï¼Œé«˜åº¦å¯å®šåˆ¶ |
| **Seaborn** | ç»Ÿè®¡å¯è§†åŒ– | ç¾è§‚ç®€æ´ï¼Œç»Ÿè®¡å›¾è¡¨ |
| **Plotly** | äº¤äº’å¼å›¾è¡¨ | åŠ¨æ€äº¤äº’ï¼Œæ”¯æŒ Web |

**æœ€ä½³å®è·µ**ï¼š
- æ•°æ®å¤„ç†é¦–é€‰ Pandas + NumPy
- å¿«é€Ÿæ¢ç´¢ç”¨ Seaborn
- ç²¾ç»†æ§åˆ¶ç”¨ Matplotlib
- äº¤äº’å¼å±•ç¤ºç”¨ Plotly

---

**ä¸‹ä¸€èŠ‚ï¼š[5.6 å°ç»“å’Œå¤ä¹ ](5.6-å°ç»“å’Œå¤ä¹ .md)**
