# 4.1 æ–‡ä»¶è¯»å†™åŸºç¡€

## æ–‡ä»¶æ“ä½œ

> **ğŸ¯ å°ç™½ç†è§£**ï¼šä»€ä¹ˆæ˜¯ `with open()` è¯­å¥ï¼Ÿ
>
> æƒ³è±¡ä½ å»å›¾ä¹¦é¦†å€Ÿä¹¦ï¼š
>
> 1. **è¿›é—¨** â†’ æ‰“å¼€æ–‡ä»¶ï¼ˆ`open()`ï¼‰
> 2. **å€Ÿä¹¦/è¿˜ä¹¦** â†’ è¯»å–/å†™å…¥å†…å®¹
> 3. **å‡ºé—¨** â†’ å…³é—­æ–‡ä»¶ï¼ˆè‡ªåŠ¨å®Œæˆï¼ï¼‰
>
> **`with` è¯­å¥å°±æ˜¯ä¸€ä¸ª"è‡ªåŠ¨å…³é—¨"çš„ä¿é•–**ï¼š
>
> ```
> with open(...) as f:    # å¼€é—¨ï¼Œç»™ä½ ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ f
>     # åœ¨è¿™é‡Œåšäº‹æƒ…
> # ç¦»å¼€ with å—åï¼Œé—¨è‡ªåŠ¨å…³ä¸Š
> ```
>
> **ä¸ºä»€ä¹ˆè¦ç”¨ `with`ï¼Ÿ**
>
> - **ä¸ç”¨ with**ï¼šä½ è¦æ‰‹åŠ¨è°ƒç”¨ `f.close()`ï¼Œå¿˜äº†å°±ä¼š"èµ„æºæ³„éœ²"ï¼ˆå°±åƒå€Ÿäº†ä¹¦ä¸è¿˜ï¼‰
> - **ç”¨ with**ï¼šè‡ªåŠ¨å¸®ä½ å…³ï¼Œå°±ç®—ä»£ç å‡ºé”™ä¹Ÿä¼šå…³ï¼ˆPython çš„"å¥½ä¹ æƒ¯"ï¼‰
>
> **å‚æ•°è§£é‡Š**ï¼š
>
> | å‚æ•° | å«ä¹‰ | ç±»æ¯” |
> |------|------|------|
> | `"config.txt"` | æ–‡ä»¶å/è·¯å¾„ | ä¹¦å |
> | `"w"` | å†™å…¥æ¨¡å¼ï¼ˆwriteï¼‰ | æ‹¿ç©ºç™½æœ¬å­å†™å­— |
> | `"r"` | è¯»å–æ¨¡å¼ï¼ˆreadï¼‰ | çœ‹ä¹¦ |
> | `"a"` | è¿½åŠ æ¨¡å¼ï¼ˆappendï¼‰ | åœ¨æœ¬å­åé¢ç»§ç»­å†™ |
> | `encoding="utf-8"` | ç¼–ç æ ¼å¼ | ç”¨ä»€ä¹ˆè¯­è¨€å†™ï¼ˆä¸­æ–‡å¿…é¡»ç”¨ utf-8ï¼ï¼‰|
>
> **âš ï¸ é‡è¦æé†’**ï¼š`"w"` æ¨¡å¼ä¼š**æ¸…ç©º**åŸæ–‡ä»¶å†…å®¹ï¼æƒ³ä¿ç•™åŸå†…å®¹ï¼Œç”¨ `"a"`ï¼ˆè¿½åŠ ï¼‰ã€‚

```python
# å†™å…¥æ–‡ä»¶
with open("config.txt", "w", encoding="utf-8") as f:
    f.write("model=gpt-4\n")
    f.write("temperature=0.7\n")

# è¯»å–æ–‡ä»¶
with open("config.txt", "r", encoding="utf-8") as f:
    content = f.read()
    print(content)

# é€è¡Œè¯»å–
with open("config.txt", "r", encoding="utf-8") as f:
    for line in f:
        print(line.strip())
```

## pathlib è·¯å¾„ç®¡ç†

> **ğŸ¯ å°ç™½ç†è§£**ï¼šä»€ä¹ˆæ˜¯ pathlibï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨å®ƒï¼Ÿ
>
> **ä¼ ç»Ÿæ–¹å¼å¤„ç†è·¯å¾„**ï¼ˆéº»çƒ¦ä¸”å®¹æ˜“å‡ºé”™ï¼‰ï¼š
>
> ```python
> # æ‹¼æ¥è·¯å¾„è¦ç”¨ os.path.join
> import os
> path = os.path.join("configs", "agent.json")  # ç¹çï¼
> ```
>
> **pathlib æ–¹å¼**ï¼ˆç°ä»£ã€ä¼˜é›…ï¼‰ï¼š
>
> ```python
> from pathlib import Path
> path = Path("configs") / "agent.json"  # ç®€æ´ï¼åƒå†™åœ°å€ä¸€æ ·
> ```
>
> **ä¸ºä»€ä¹ˆç”¨ `/` æ‹¼æ¥è·¯å¾„ï¼Ÿ**
>
> Python å…è®¸è‡ªå®šä¹‰è¿ç®—ç¬¦è¡Œä¸ºã€‚`Path` å¯¹è±¡é‡æ–°å®šä¹‰äº† `/` çš„å«ä¹‰ï¼š
>
> - æ™®é€šæ•°å­—ï¼š`10 / 2` = 5ï¼ˆé™¤æ³•ï¼‰
> - Path å¯¹è±¡ï¼š`Path("a") / "b"` = `Path("a/b")`ï¼ˆè·¯å¾„æ‹¼æ¥ï¼‰
>
> **pathlib çš„å¥½å¤„**ï¼š
>
> | æ“ä½œ | ä¼ ç»Ÿæ–¹å¼ | pathlib æ–¹å¼ |
> |------|---------|-------------|
> | æ‹¼æ¥è·¯å¾„ | `os.path.join(a, b)` | `a / b` |
> | è¯»å–æ–‡ä»¶ | `open(path).read()` | `path.read_text()` |
> | åˆ›å»ºç›®å½• | `os.makedirs(path)` | `path.mkdir()` |
> | æ£€æŸ¥å­˜åœ¨ | `os.path.exists(path)` | `path.exists()` |
>
> **ç±»æ¯”**ï¼š`pathlib` å°±åƒä¸€ä¸ªæ™ºèƒ½å¯¼èˆªï¼Œä¸ç®¡ä½ åœ¨ Windowsï¼ˆ`\`ï¼‰è¿˜æ˜¯ Mac/Linuxï¼ˆ`/`ï¼‰ï¼Œå®ƒéƒ½èƒ½è‡ªåŠ¨å¤„ç†è·¯å¾„åˆ†éš”ç¬¦ï¼

```python
from pathlib import Path

# åˆ›å»ºè·¯å¾„å¯¹è±¡
config_dir = Path("configs")
config_file = config_dir / "agent.json"

# åˆ›å»ºç›®å½•
config_dir.mkdir(parents=True, exist_ok=True)

# å†™å…¥æ–‡ä»¶
config_file.write_text('{"model": "gpt-4"}', encoding="utf-8")

# è¯»å–æ–‡ä»¶
content = config_file.read_text(encoding="utf-8")
print(content)

# æ£€æŸ¥å­˜åœ¨
if config_file.exists():
    print(f"æ–‡ä»¶å¤§å°: {config_file.stat().st_size} å­—èŠ‚")
```

---

**ä¸‹ä¸€èŠ‚ï¼š[4.2 JSON ä¸ YAML](4.2-JSONä¸YAML.md)**
