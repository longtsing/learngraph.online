# 6.1 异步编程基础

## async/await 语法

```python
import asyncio

async def fetch_data(id: int) -> str:
    """异步获取数据"""
    await asyncio.sleep(1)  # 模拟 I/O 操作
    return f"数据 {id}"

async def main():
    # 顺序执行（慢）
    result1 = await fetch_data(1)
    result2 = await fetch_data(2)
    print(f"顺序: {result1}, {result2}")
    
    # 并发执行（快）
    results = await asyncio.gather(
        fetch_data(1),
        fetch_data(2),
        fetch_data(3)
    )
    print(f"并发: {results}")

# 运行
asyncio.run(main())
```

## 异步 Agent 实现

```python
import asyncio
from typing import List

class AsyncAgent:
    """异步 Agent"""
    
    def __init__(self, name: str):
        self.name = name
    
    async def process_task(self, task: str) -> str:
        """处理单个任务"""
        await asyncio.sleep(0.5)  # 模拟处理
        return f"[{self.name}] 完成: {task}"
    
    async def process_batch(self, tasks: List[str]) -> List[str]:
        """批量处理任务"""
        results = await asyncio.gather(
            *[self.process_task(task) for task in tasks]
        )
        return results

async def main():
    agent = AsyncAgent("WorkerBot")
    tasks = ["任务1", "任务2", "任务3"]
    
    import time
    start = time.time()
    results = await agent.process_batch(tasks)
    end = time.time()
    
    print(f"结果: {results}")
    print(f"耗时: {end - start:.2f}秒")  # ~0.5秒（并发）

asyncio.run(main())
```

---

**下一节：[6.2 异步工具和上下文](6.2-异步工具和上下文.md)**
