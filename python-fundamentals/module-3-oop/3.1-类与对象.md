# 3.1 类与对象：Agent 的抽象

## 类的基础

```python
class Agent:
    """简单的 Agent 类"""
    
    def __init__(self, name: str, model: str = "gpt-3.5-turbo"):
        """初始化方法"""
        self.name = name
        self.model = model
        self.messages = []
    
    def add_message(self, role: str, content: str) -> None:
        """添加消息"""
        self.messages.append({"role": role, "content": content})
    
    def get_history(self) -> list:
        """获取历史"""
        return self.messages

# 创建实例
agent = Agent("ResearchBot", "gpt-4")
agent.add_message("user", "Hello")
print(agent.get_history())
```

## 实战：完整的 Agent 类

```python
from typing import Optional, List, Dict
from dataclasses import dataclass, field

@dataclass
class Message:
    role: str
    content: str

class ConversationalAgent:
    """对话型 Agent"""
    
    def __init__(
        self,
        name: str,
        model: str = "gpt-3.5-turbo",
        system_prompt: Optional[str] = None
    ):
        self.name = name
        self.model = model
        self.system_prompt = system_prompt or "You are a helpful assistant."
        self._messages: List[Message] = []
        self._stats = {"total_messages": 0}
    
    def chat(self, user_input: str) -> str:
        """对话"""
        # 添加用户消息
        self._messages.append(Message("user", user_input))
        self._stats["total_messages"] += 1
        
        # 模拟 LLM 响应
        response = f"[{self.name}] 收到: {user_input}"
        self._messages.append(Message("assistant", response))
        self._stats["total_messages"] += 1
        
        return response
    
    @property
    def message_count(self) -> int:
        """消息数量（只读属性）"""
        return len(self._messages)
    
    def clear_history(self) -> None:
        """清空历史"""
        self._messages = []

# 使用
agent = ConversationalAgent("ChatBot")
print(agent.chat("你好"))
print(f"消息数: {agent.message_count}")
```

---

**下一节：[3.2 继承与多态](3.2-继承与多态.md)**
