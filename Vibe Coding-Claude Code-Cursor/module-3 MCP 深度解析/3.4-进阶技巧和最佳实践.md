# 3.4 è¿›é˜¶æŠ€å·§å’Œæœ€ä½³å®è·µ

## ğŸ¯ æœ¬èŠ‚ç›®æ ‡

å­¦å®Œæœ¬èŠ‚åï¼Œä½ å°†æŒæ¡ï¼š
- âœ… é«˜çº§é…ç½®æŠ€å·§ï¼ˆå¤šç¯å¢ƒã€æ¡ä»¶é…ç½®ã€ä½œç”¨åŸŸç­–ç•¥ï¼‰
- âœ… æ€§èƒ½ä¼˜åŒ–æ–¹æ³•ï¼ˆToken ç®¡ç†ã€ä¸Šä¸‹æ–‡æ•ˆç‡ï¼‰
- âœ… å›¢é˜Ÿåä½œæœ€ä½³å®è·µï¼ˆGit å·¥ä½œæµã€å®¡æ‰¹æµç¨‹ï¼‰
- âœ… ä¸‰çº§è°ƒè¯•æ–¹æ³•è®ºï¼ˆç³»ç»ŸåŒ–é—®é¢˜è¯Šæ–­ï¼‰
- âœ… ä¼ä¸šçº§å®‰å…¨åŠ å›ºï¼ˆæƒé™æ§åˆ¶ã€å®¡è®¡ã€åˆè§„ï¼‰

---

## ğŸš€ é«˜çº§é…ç½®æŠ€å·§

### æŠ€å·§ 1ï¼šå¤šç¯å¢ƒé…ç½®ç®¡ç†

**åœºæ™¯ï¼š** ä½ éœ€è¦åœ¨å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒé—´åˆ‡æ¢ï¼Œæ¯ä¸ªç¯å¢ƒæœ‰ä¸åŒçš„æ•°æ®åº“å’Œ API ç«¯ç‚¹ã€‚

**è§£å†³æ–¹æ¡ˆï¼šç¯å¢ƒå˜é‡ + é…ç½®æ¨¡æ¿**

**é¡¹ç›®é…ç½®ï¼š`.mcp.json`**
```json
{
  "mcpServers": {
    "database": {
      "type": "stdio",
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-postgres"],
      "env": {
        "DB_URL": "${DATABASE_URL}"
      }
    },
    "api-backend": {
      "type": "http",
      "url": "${BACKEND_API_URL:-https://api.production.com}/mcp",
      "headers": {
        "Authorization": "Bearer ${API_TOKEN}",
        "X-Environment": "${APP_ENV:-production}"
      }
    }
  }
}
```

**ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š**

`.env.development`:
```bash
DATABASE_URL=postgresql://localhost:5432/myapp_dev
BACKEND_API_URL=https://api.dev.company.com
API_TOKEN=dev_token_12345
APP_ENV=development
```

`.env.staging`:
```bash
DATABASE_URL=postgresql://staging-db.company.com:5432/myapp_staging
BACKEND_API_URL=https://api.staging.company.com
API_TOKEN=staging_token_67890
APP_ENV=staging
```

`.env.production`:
```bash
DATABASE_URL=postgresql://prod-db.company.com:5432/myapp_prod
BACKEND_API_URL=https://api.company.com
API_TOKEN=prod_token_secure_xyz
APP_ENV=production
```

**å¿«é€Ÿåˆ‡æ¢ï¼š**
```bash
# å¼€å‘ç¯å¢ƒ
cp .env.development .env
source .env
claude

# æµ‹è¯•ç¯å¢ƒ
cp .env.staging .env
source .env
claude

# æˆ–è€…ä½¿ç”¨ direnv è‡ªåŠ¨åŠ è½½
# .envrc
source_env .env.development
```

### æŠ€å·§ 2ï¼šæ¡ä»¶é…ç½®å’Œç‰¹æ€§å¼€å…³

**åœºæ™¯ï¼š** æŸäº› MCP æœåŠ¡å™¨åªåœ¨ç‰¹å®šæ¡ä»¶ä¸‹å¯ç”¨ã€‚

**æ–¹æ¡ˆ Aï¼šä½¿ç”¨ `disabled` å­—æ®µ**
```json
{
  "mcpServers": {
    "experimental-feature": {
      "disabled": true,  // å¿«é€Ÿç¦ç”¨
      "type": "http",
      "url": "https://experimental.api.com/mcp"
    },
    "legacy-system": {
      "disabled": "${ENABLE_LEGACY:-true}",  // ç¯å¢ƒå˜é‡æ§åˆ¶
      "type": "stdio",
      "command": "legacy-server"
    }
  }
}
```

**æ–¹æ¡ˆ Bï¼šå¤šä¸ªé…ç½®æ–‡ä»¶**
```bash
# åŸºç¡€é…ç½®
~/.claude.json

# å®éªŒæ€§åŠŸèƒ½
~/.claude.experimental.json

# æŒ‰éœ€åˆå¹¶
cat ~/.claude.json ~/.claude.experimental.json | \
  jq -s '.[0] * .[1]' > ~/.claude.merged.json
```

### æŠ€å·§ 3ï¼šåˆ†å±‚é…ç½®ç»§æ‰¿

**é…ç½®ä¼˜å…ˆçº§ï¼š** Local > Project > User > Managed

**ç¤ºä¾‹åœºæ™¯ï¼š**

**Managedï¼ˆIT ç®¡ç†å‘˜ï¼‰ï¼š**
```json
// /etc/claude-code/managed-mcp.json
{
  "allowedMcpServers": [
    {"serverName": "github"},
    {"serverName": "sentry"},
    {"serverName": "approved-internal-api"}
  ],
  "deniedMcpServers": [
    {"serverName": "filesystem"}  // å®‰å…¨ç­–ç•¥ï¼šç¦æ­¢æ–‡ä»¶è®¿é—®
  ],
  "requiredMcpServers": {
    "security-scanner": {
      "type": "http",
      "url": "https://security.company.com/mcp"
    }
  }
}
```

**Userï¼ˆä¸ªäººå…¨å±€è®¾ç½®ï¼‰ï¼š**
```json
// ~/.claude.json
{
  "mcpServers": {
    "github": {
      "type": "http",
      "url": "https://mcp.github.com/anthropic"
    },
    "personal-notes": {
      "type": "http",
      "url": "https://mcp.notion.com/mcp"
    }
  }
}
```

**Projectï¼ˆå›¢é˜Ÿå…±äº«ï¼‰ï¼š**
```json
// /project/.mcp.json
{
  "mcpServers": {
    "project-db": {
      "type": "stdio",
      "command": "npx",
      "args": ["-y", "postgres-server"],
      "env": {"DB_URL": "${PROJECT_DB_URL}"}
    }
  }
}
```

**Localï¼ˆé¡¹ç›®ä¸ªäººè¦†ç›–ï¼‰ï¼š**
```json
// /project/.claude/settings.local.json
{
  "mcpServers": {
    "project-db": {
      "env": {
        "DB_URL": "postgresql://localhost:5432/my_local_test_db"
      }
    }
  }
}
```

**æœ€ç»ˆç”Ÿæ•ˆé…ç½®ï¼š**
- âœ… `security-scanner`ï¼ˆManaged å¼ºåˆ¶ï¼‰
- âœ… `github`ï¼ˆUser å…¨å±€ï¼‰
- âœ… `personal-notes`ï¼ˆUser å…¨å±€ï¼‰
- âœ… `project-db`ï¼ˆProject + Local è¦†ç›–æ•°æ®åº“ URLï¼‰
- âŒ `filesystem`ï¼ˆManaged ç¦æ­¢ï¼‰

### æŠ€å·§ 4ï¼šåŠ¨æ€æœåŠ¡å™¨é…ç½®ï¼ˆæ’ä»¶ç³»ç»Ÿï¼‰

**é«˜çº§åœºæ™¯ï¼š** å¼€å‘å¯é‡ç”¨çš„ MCP é…ç½®åŒ…ã€‚

**æ’ä»¶ç»“æ„ï¼š**
```
my-mcp-plugin/
â”œâ”€â”€ plugin.json
â”œâ”€â”€ servers/
â”‚   â”œâ”€â”€ custom-db-server.js
â”‚   â””â”€â”€ custom-api-server.js
â”œâ”€â”€ config/
â”‚   â””â”€â”€ mcp-config.json
â””â”€â”€ README.md
```

**plugin.jsonï¼š**
```json
{
  "name": "my-company-mcp-plugin",
  "version": "1.0.0",
  "mcpServers": {
    "company-db": {
      "command": "${CLAUDE_PLUGIN_ROOT}/servers/custom-db-server.js",
      "args": ["--config", "${CLAUDE_PLUGIN_ROOT}/config/db-config.json"],
      "env": {
        "DB_URL": "${COMPANY_DB_URL}"
      }
    }
  }
}
```

**ä½¿ç”¨æ’ä»¶ï¼š**
```json
// ~/.claude.json
{
  "plugins": [
    "/path/to/my-mcp-plugin"
  ]
}
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### ç­–ç•¥ 1ï¼šToken é¢„ç®—ç®¡ç†

**é—®é¢˜ï¼š** MCP æœåŠ¡å™¨è¾“å‡ºè¿‡å¤§å¯¼è‡´ token æ¶ˆè€—çˆ†ç‚¸ã€‚

**è§£å†³æ–¹æ¡ˆï¼šé…ç½®è¾“å‡ºé™åˆ¶**

```bash
# è®¾ç½® MCP è¾“å‡º token é™åˆ¶
export MAX_MCP_OUTPUT_TOKENS=50000

# é»˜è®¤ï¼š25,000 tokens
# è­¦å‘Šé˜ˆå€¼ï¼š10,000 tokens

claude
```

**ç¤ºä¾‹ï¼šæ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**

âŒ **ä½æ•ˆæŸ¥è¯¢ï¼š**
```sql
SELECT * FROM users;  -- è¿”å› 100,000 è¡Œ
```

âœ… **ä¼˜åŒ–æŸ¥è¯¢ï¼š**
```sql
SELECT id, email, name FROM users
WHERE status = 'active'
LIMIT 100;  -- åªè¿”å›å¿…è¦çš„åˆ—å’Œè¡Œ
```

**åœ¨ Skill ä¸­æŒ‡å¯¼ Claudeï¼š**
```markdown
---
name: database-query-optimizer
description: æŸ¥è¯¢æ•°æ®åº“æ—¶è‡ªåŠ¨ä¼˜åŒ– SQL
---

# æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–è§„åˆ™

å½“æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢æ—¶ï¼Œå§‹ç»ˆéµå¾ªï¼š

1. **åªé€‰æ‹©å¿…è¦çš„åˆ—**
   - âŒ `SELECT *`
   - âœ… `SELECT id, name, email`

2. **ä½¿ç”¨ LIMIT é™åˆ¶ç»“æœ**
   - æ¢ç´¢æ€§æŸ¥è¯¢ï¼š`LIMIT 10`
   - ç”Ÿäº§æŸ¥è¯¢ï¼š`LIMIT 100`

3. **è¿‡æ»¤ä¸å¿…è¦çš„æ•°æ®**
   - ä½¿ç”¨ WHERE æ¡ä»¶
   - é¿å…å…¨è¡¨æ‰«æ

4. **èšåˆä¼˜å…ˆ**
   - éœ€è¦ç»Ÿè®¡ï¼Ÿä½¿ç”¨ `COUNT(*)`ã€`SUM()`
   - ä¸è¦å–å›æ‰€æœ‰æ•°æ®åå†è®¡ç®—
```

### ç­–ç•¥ 2ï¼šæ¸è¿›å¼å·¥å…·åŠ è½½

**åŸç†ï¼š** MCP æ”¯æŒæŒ‰éœ€åŠ è½½å·¥å…·å®šä¹‰ï¼Œè€Œéä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰å·¥å…·ã€‚

**å®ç°ï¼š** ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ç»„ç»‡å·¥å…·

**æœåŠ¡å™¨ç«¯å®ç°ç¤ºä¾‹ï¼ˆNode.jsï¼‰ï¼š**
```javascript
// mcp-server.js
const server = new MCPServer({
  tools: {
    // æ‡’åŠ è½½ï¼šåªæœ‰è¢«è°ƒç”¨æ—¶æ‰åŠ è½½å®Œæ•´å®šä¹‰
    async listTools() {
      return {
        tools: [
          {name: "github_create_pr", description: "Create a PR"},
          {name: "github_list_issues", description: "List issues"},
          // ... åªè¿”å›åç§°å’Œç®€çŸ­æè¿°ï¼Œä¸è¿”å›å®Œæ•´ schema
        ]
      };
    },
    async getTool(name) {
      // æŒ‰éœ€åŠ è½½å®Œæ•´å®šä¹‰
      const toolDefs = {
        "github_create_pr": {
          name: "github_create_pr",
          description: "Create a new pull request",
          inputSchema: { /* å®Œæ•´ JSON Schema */ }
        },
        // ...
      };
      return toolDefs[name];
    }
  }
});
```

**å®¢æˆ·ç«¯è¡Œä¸ºï¼š**
1. å¯åŠ¨æ—¶ï¼šè°ƒç”¨ `listTools()` â†’ åªè·å–å·¥å…·åç§°ï¼ˆ< 1KBï¼‰
2. éœ€è¦æ—¶ï¼šè°ƒç”¨ `getTool(name)` â†’ è·å–å®Œæ•´å®šä¹‰ï¼ˆæŒ‰éœ€ï¼‰
3. ç»“æœï¼šToken ä½¿ç”¨å‡å°‘ 95%+

### ç­–ç•¥ 3ï¼šä¸­é—´ç»“æœç¼“å­˜

**åœºæ™¯ï¼š** é‡å¤æŸ¥è¯¢ç›¸åŒæ•°æ®ï¼ˆå¦‚æ•°æ®åº“ schemaï¼‰ã€‚

**æ–¹æ¡ˆ Aï¼šæœåŠ¡å™¨ç«¯ç¼“å­˜**
```javascript
// mcp-server.js
const cache = new Map();

async function getSchema(tableName) {
  const cacheKey = `schema:${tableName}`;

  if (cache.has(cacheKey)) {
    return cache.get(cacheKey);  // å‘½ä¸­ç¼“å­˜
  }

  const schema = await db.query(`
    SELECT column_name, data_type
    FROM information_schema.columns
    WHERE table_name = $1
  `, [tableName]);

  cache.set(cacheKey, schema, {ttl: 3600});  // ç¼“å­˜ 1 å°æ—¶
  return schema;
}
```

**æ–¹æ¡ˆ Bï¼šClaude è®°å¿†ï¼ˆSkillsï¼‰**
```markdown
---
name: remember-schema
description: è®°ä½å·²æŸ¥è¯¢çš„æ•°æ®åº“ schema
---

# Schema è®°å¿†

å·²æŸ¥è¯¢çš„è¡¨ç»“æ„ï¼š

## users è¡¨
- id (INTEGER, PRIMARY KEY)
- email (VARCHAR(255), UNIQUE)
- name (VARCHAR(100))
- created_at (TIMESTAMP)

## posts è¡¨
- id (INTEGER, PRIMARY KEY)
- user_id (INTEGER, FOREIGN KEY â†’ users.id)
- title (VARCHAR(200))
- content (TEXT)
- created_at (TIMESTAMP)

**è§„åˆ™ï¼š** å¦‚æœå·²ç»æœ‰ schema ä¿¡æ¯ï¼Œä¸è¦é‡æ–°æŸ¥è¯¢ã€‚
```

### ç­–ç•¥ 4ï¼šå¹¶è¡Œå·¥å…·è°ƒç”¨

**åœºæ™¯ï¼š** éœ€è¦ä»å¤šä¸ªæœåŠ¡è·å–æ•°æ®ã€‚

**ä¸²è¡Œè°ƒç”¨ï¼ˆæ…¢ï¼‰ï¼š**
```
è°ƒç”¨ GitHub API â†’ ç­‰å¾… 2 ç§’
è°ƒç”¨ Sentry API â†’ ç­‰å¾… 1.5 ç§’
è°ƒç”¨ PostgreSQL â†’ ç­‰å¾… 0.5 ç§’
æ€»è€—æ—¶ï¼š4 ç§’
```

**å¹¶è¡Œè°ƒç”¨ï¼ˆå¿«ï¼‰ï¼š**
```
åŒæ—¶è°ƒç”¨ï¼š
  - GitHub API
  - Sentry API
  - PostgreSQL
ç­‰å¾…æ‰€æœ‰å®Œæˆ
æ€»è€—æ—¶ï¼š2 ç§’ï¼ˆæœ€æ…¢çš„é‚£ä¸ªï¼‰
```

**Claude ä¼šè‡ªåŠ¨å¹¶è¡ŒåŒ–ç‹¬ç«‹çš„å·¥å…·è°ƒç”¨ã€‚**

**ä¼˜åŒ–æç¤ºï¼š**
```
> åŒæ—¶è·å– GitHub æœ€æ–° PR å’Œ Sentry æœ€æ–°é”™è¯¯

Claude ä¼šå¹¶è¡Œæ‰§è¡Œï¼š
[å·¥å…·è°ƒç”¨ 1] github_list_prs()
[å·¥å…·è°ƒç”¨ 2] sentry_list_issues()

è€Œä¸æ˜¯ä¸²è¡Œæ‰§è¡Œã€‚
```

---

## ğŸ‘¥ å›¢é˜Ÿåä½œæœ€ä½³å®è·µ

### å®è·µ 1ï¼šGit å·¥ä½œæµ

**æ¨èæ–‡ä»¶ç»“æ„ï¼š**
```
project/
â”œâ”€â”€ .mcp.json                    # âœ… æäº¤ï¼ˆå›¢é˜Ÿå…±äº«é…ç½®ï¼‰
â”œâ”€â”€ .env.example                 # âœ… æäº¤ï¼ˆé…ç½®æ¨¡æ¿ï¼‰
â”œâ”€â”€ .env                         # âŒ ä¸æäº¤ï¼ˆä¸ªäººå‡­æ®ï¼‰
â”œâ”€â”€ .gitignore                   # âœ… åŒ…å« .env
â”œâ”€â”€ .claude/
â”‚   â”œâ”€â”€ skills/                  # âœ… æäº¤ï¼ˆå›¢é˜Ÿ Skillsï¼‰
â”‚   â”œâ”€â”€ settings.local.json      # âŒ ä¸æäº¤ï¼ˆä¸ªäººè®¾ç½®ï¼‰
â”‚   â””â”€â”€ README.md                # âœ… æäº¤ï¼ˆè®¾ç½®è¯´æ˜ï¼‰
â””â”€â”€ README.md                    # âœ… åŒ…å« MCP è®¾ç½®æŒ‡å—
```

**.gitignoreï¼š**
```
# Environment files
.env
.env.local
.env.*.local

# Claude Code personal settings
.claude/settings.local.json

# Logs
*.log
```

**.mcp.jsonï¼ˆå›¢é˜Ÿå…±äº«ï¼‰ï¼š**
```json
{
  "mcpServers": {
    "project-db": {
      "type": "stdio",
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-postgres"],
      "env": {
        "DB_URL": "${PROJECT_DB_URL}"
      }
    },
    "github": {
      "type": "http",
      "url": "https://mcp.github.com/anthropic"
    }
  }
}
```

**.env.exampleï¼ˆæ¨¡æ¿ï¼‰ï¼š**
```bash
# Database Connection
PROJECT_DB_URL=postgresql://user:password@host:5432/dbname

# GitHub (OAuth will handle authentication)
# No token needed in .env

# Other services
SENTRY_ORG=your-org-name
LINEAR_TEAM_ID=your-team-id
```

**README.md è®¾ç½®è¯´æ˜ï¼š**
```markdown
## Claude Code Setup

### 1. Install Dependencies
```bash
npm install
```

### 2. Configure Environment
```bash
# Copy example environment file
cp .env.example .env

# Edit .env with your credentials
nano .env
```

### 3. Approve MCP Servers
```bash
# Start Claude Code
claude

# Approve project MCP servers when prompted
# - project-db
# - github
```

### 4. Authenticate Remote Services
```
> /mcp
# Click "Login" for each remote service
```

### 5. Verify Setup
```
> /mcp
# All servers should show âœ… Connected
```
```

### å®è·µ 2ï¼šä»£ç å®¡æŸ¥å·¥ä½œæµ

**åœºæ™¯ï¼š** å›¢é˜Ÿæˆå‘˜æäº¤åŒ…å« MCP é…ç½®æ›´æ”¹çš„ PRã€‚

**å®¡æŸ¥æ¸…å•ï¼š**

```markdown
## MCP Configuration Review Checklist

### å®‰å…¨æ€§
- [ ] æ²¡æœ‰ç¡¬ç¼–ç çš„å¯†ç æˆ– API keys
- [ ] æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç¯å¢ƒå˜é‡å¼•ç”¨
- [ ] `.env` æ–‡ä»¶ä¸åœ¨æäº¤ä¸­
- [ ] `.env.example` å·²æ›´æ–°

### é…ç½®æ­£ç¡®æ€§
- [ ] JSON è¯­æ³•æœ‰æ•ˆï¼ˆä½¿ç”¨ `jq` æˆ– linter éªŒè¯ï¼‰
- [ ] æœåŠ¡å™¨åç§°æ¸…æ™°æ˜ç¡®
- [ ] ä¼ è¾“ç±»å‹æ­£ç¡®ï¼ˆHTTP/Stdioï¼‰
- [ ] å‘½ä»¤å’Œå‚æ•°æ­£ç¡®

### æ–‡æ¡£
- [ ] README åŒ…å«æ–°æœåŠ¡å™¨çš„è®¾ç½®è¯´æ˜
- [ ] `.env.example` åŒ…å«æ–°çš„ç¯å¢ƒå˜é‡
- [ ] å˜æ›´è¯´æ˜äº†ä¸ºä»€ä¹ˆéœ€è¦æ–°æœåŠ¡å™¨

### å½±å“è¯„ä¼°
- [ ] æ–°æœåŠ¡å™¨æ˜¯å¿…éœ€çš„ï¼Œè¿˜æ˜¯å¯é€‰çš„ï¼Ÿ
- [ ] æ˜¯å¦å½±å“å…¶ä»–å›¢é˜Ÿæˆå‘˜çš„å·¥ä½œæµï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦é¢å¤–çš„æƒé™æˆ–è®¿é—®å®¡æ‰¹ï¼Ÿ

### æµ‹è¯•
- [ ] æäº¤è€…å·²éªŒè¯é…ç½®å·¥ä½œæ­£å¸¸
- [ ] è‡³å°‘ä¸€ä¸ªå…¶ä»–å›¢é˜Ÿæˆå‘˜æˆåŠŸå¤ç°
```

**PR æ¨¡æ¿ç¤ºä¾‹ï¼š**
```markdown
## MCP Configuration Change

**æ·»åŠ çš„æœåŠ¡å™¨ï¼š** `linear`
**ç±»å‹ï¼š** Remote (HTTP)
**ç”¨é€”ï¼š** è‡ªåŠ¨åŒ– issue åˆ›å»ºå’Œé¡¹ç›®ç®¡ç†

### Setup Instructions
1. è®¤è¯ Linearï¼š
   ```
   > /mcp
   # Click "Login" for Linear
   ```

2. è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰ï¼š
   ```bash
   echo "LINEAR_TEAM_ID=your-team-id" >> .env
   ```

### Testing
- [x] æµ‹è¯• `linear_create_issue` å·¥å…·
- [x] æµ‹è¯• `linear_list_issues` å·¥å…·
- [x] éªŒè¯æƒé™èŒƒå›´æ­£ç¡®

### Security
- [x] ä½¿ç”¨ OAuthï¼ˆæ— éœ€ API keyï¼‰
- [x] è¯·æ±‚çš„æƒé™ï¼š`read`, `write`
- [x] å®¡æŸ¥äº† Linear çš„æ•°æ®è®¿é—®ç­–ç•¥

### Checklist
- [x] JSON è¯­æ³•éªŒè¯é€šè¿‡
- [x] `.env.example` å·²æ›´æ–°
- [x] README å·²æ›´æ–°
- [x] è‡³å°‘ 2 äººæµ‹è¯•æˆåŠŸ
```

### å®è·µ 3ï¼šCI/CD é›†æˆ

**åœºæ™¯ï¼š** åœ¨ CI æµæ°´çº¿ä¸­ä½¿ç”¨ Claude Code å’Œ MCPã€‚

**GitHub Actions ç¤ºä¾‹ï¼š**

`.github/workflows/claude-code-checks.yml`:
```yaml
name: Claude Code Quality Checks

on: [push, pull_request]

jobs:
  mcp-config-validation:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Validate MCP Configuration
        run: |
          # éªŒè¯ JSON è¯­æ³•
          jq empty .mcp.json

          # æ£€æŸ¥æ•æ„Ÿä¿¡æ¯æ³„éœ²
          if grep -r "password\|secret\|token" .mcp.json; then
            echo "âŒ Error: Potential secret in .mcp.json"
            exit 1
          fi

      - name: Verify .env.example
        run: |
          # ç¡®ä¿æ‰€æœ‰ç¯å¢ƒå˜é‡éƒ½æœ‰ç¤ºä¾‹
          required_vars=$(grep -oP '\$\{\K[^}]+' .mcp.json | sort -u)
          example_vars=$(grep -oP '^[A-Z_]+(?==)' .env.example | sort -u)

          missing=$(comm -23 <(echo "$required_vars") <(echo "$example_vars"))
          if [ -n "$missing" ]; then
            echo "âŒ Missing in .env.example: $missing"
            exit 1
          fi

  automated-testing:
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:14
        env:
          POSTGRES_PASSWORD: test_password
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5

    steps:
      - uses: actions/checkout@v3

      - name: Setup Claude Code
        run: |
          npm install -g @anthropic/claude-code
          cp .env.example .env
          # è®¾ç½®æµ‹è¯•ç¯å¢ƒå˜é‡
          echo "PROJECT_DB_URL=postgresql://postgres:test_password@localhost:5432/test" >> .env

      - name: Test MCP Servers
        env:
          CLAUDE_API_KEY: ${{ secrets.CLAUDE_API_KEY }}
        run: |
          # éäº¤äº’æ¨¡å¼æµ‹è¯•
          claude -p "List all configured MCP servers" --output json > mcp_status.json

          # éªŒè¯æ‰€æœ‰æœåŠ¡å™¨è¿æ¥æˆåŠŸ
          jq -e '.servers[] | select(.status != "connected")' mcp_status.json && exit 1 || exit 0
```

---

## ğŸ” ä¸‰çº§è°ƒè¯•æ–¹æ³•è®º

### Level 1ï¼šè¿æ¥å’Œé…ç½®é—®é¢˜

**ç—‡çŠ¶ï¼š** MCP æœåŠ¡å™¨æ— æ³•è¿æ¥æˆ–æœªæ˜¾ç¤ºã€‚

**è¯Šæ–­æ­¥éª¤ï¼š**

**1.1 æ£€æŸ¥æœåŠ¡å™¨åˆ—è¡¨**
```
> /mcp
```

é¢„æœŸè¾“å‡ºï¼š
```
MCP Servers Status:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¦ github
   Status: âœ… Connected
ğŸ“¦ postgres
   Status: âŒ Failed to connect
   Error: Command not found: npx
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**1.2 éªŒè¯é…ç½®è¯­æ³•**
```bash
# éªŒè¯ JSON
jq empty ~/.claude.json

# æŸ¥çœ‹å…·ä½“æœåŠ¡å™¨é…ç½®
claude mcp get postgres
```

**1.3 æ£€æŸ¥ç¯å¢ƒå˜é‡**
```bash
# åˆ—å‡ºæ‰€æœ‰ç¯å¢ƒå˜é‡
env | grep -i db

# éªŒè¯ç‰¹å®šå˜é‡
echo $DATABASE_URL
```

**1.4 æµ‹è¯•å‘½ä»¤æ‰‹åŠ¨æ‰§è¡Œ**
```bash
# æµ‹è¯• MCP æœåŠ¡å™¨å‘½ä»¤æ˜¯å¦å¯æ‰§è¡Œ
npx -y @modelcontextprotocol/server-postgres

# å¦‚æœå¤±è´¥ï¼Œæ£€æŸ¥ Node.js
node --version  # åº”è¯¥ >= 18.17
```

**å¸¸è§é—®é¢˜ & è§£å†³æ–¹æ¡ˆï¼š**

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|---------|
| `Command not found: npx` | Node.js æœªå®‰è£… | `brew install node` (macOS) |
| `ENOENT: no such file` | è·¯å¾„é”™è¯¯ | ä½¿ç”¨ç»å¯¹è·¯å¾„ |
| `Permission denied` | æ–‡ä»¶æƒé™ | `chmod +x server.js` |
| `JSON parse error` | è¯­æ³•é”™è¯¯ | ä½¿ç”¨ `jq` éªŒè¯ |

### Level 2ï¼šè®¤è¯å’Œæƒé™é—®é¢˜

**ç—‡çŠ¶ï¼š** æœåŠ¡å™¨è¿æ¥æˆåŠŸï¼Œä½†å·¥å…·è°ƒç”¨å¤±è´¥ã€‚

**è¯Šæ–­æ­¥éª¤ï¼š**

**2.1 æ£€æŸ¥è®¤è¯çŠ¶æ€**
```
> /mcp

ğŸ“¦ github
   Status: âœ… Connected
   Authenticated as: yourusername  â† æ£€æŸ¥è¿™é‡Œ
   Scopes: repo, read:user         â† æ£€æŸ¥æƒé™èŒƒå›´
```

**2.2 éªŒè¯ OAuth Token**
```
# æ¸…é™¤å¹¶é‡æ–°è®¤è¯
> /mcp
# é€‰æ‹©æœåŠ¡å™¨ â†’ Clear authentication â†’ Login
```

**2.3 æ£€æŸ¥æƒé™èŒƒå›´**
```
éœ€è¦çš„æƒé™ï¼šrepo (å®Œæ•´ä»“åº“è®¿é—®)
æˆäºˆçš„æƒé™ï¼špublic_repo (åªæœ‰å…¬å¼€ä»“åº“)

è§£å†³ï¼šé‡æ–°è®¤è¯å¹¶æˆäºˆæ­£ç¡®çš„ scope
```

**2.4 æµ‹è¯•å·¥å…·æƒé™**
```
> /permissions

Allowed tools:
- Read
- Write
- Bash
âŒ mcp__github__create_pr  â† å·¥å…·è¢«é˜»æ­¢

è§£å†³ï¼š
> /permissions add mcp__github__create_pr
```

**2.5 æ£€æŸ¥ä¼ä¸šç­–ç•¥**
```bash
# æŸ¥çœ‹æ‰˜ç®¡é…ç½®
cat /etc/claude-code/managed-mcp.json

# ç¤ºä¾‹è¾“å‡ºï¼š
{
  "deniedMcpServers": [
    {"serverName": "github"}  â† IT é˜»æ­¢äº† GitHub
  ]
}

# è§£å†³ï¼šè”ç³» IT ç®¡ç†å‘˜è¯·æ±‚è®¿é—®
```

### Level 3ï¼šå·¥å…·æ‰§è¡Œå’Œæ•°æ®é—®é¢˜

**ç—‡çŠ¶ï¼š** å·¥å…·è°ƒç”¨æˆåŠŸï¼Œä½†è¿”å›æ„å¤–ç»“æœæˆ–é”™è¯¯ã€‚

**è¯Šæ–­æ­¥éª¤ï¼š**

**3.1 å¯ç”¨è°ƒè¯•æ¨¡å¼**
```bash
claude --mcp-debug
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
[MCP DEBUG] Tool call: github_create_pr
[MCP DEBUG] Parameters: {
  "title": "Add feature",
  "base": "main",
  "head": "feature-branch"
}
[MCP DEBUG] Request sent to server
[MCP DEBUG] Response received: 422 Unprocessable Entity
[MCP DEBUG] Error: {
  "message": "Validation Failed",
  "errors": [
    {
      "field": "head",
      "code": "invalid",
      "message": "Branch 'feature-branch' does not exist"
    }
  ]
}
```

**3.2 æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—**
```
> /mcp
# é€‰æ‹©æœåŠ¡å™¨
# æŸ¥çœ‹ "Recent Logs" éƒ¨åˆ†

Recent Logs (postgres):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[INFO] Connected to database
[ERROR] Query failed: syntax error at or near "SELCT"
[ERROR] Did you mean: SELECT?
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**3.3 æ‰‹åŠ¨éªŒè¯æ•°æ®**
```sql
-- ç›´æ¥è¿æ¥æ•°æ®åº“éªŒè¯æ•°æ®å­˜åœ¨
psql $DATABASE_URL

postgres=# SELECT * FROM users LIMIT 5;
-- ç¡®è®¤æ•°æ®ç¡®å®å­˜åœ¨

-- ç„¶åå†è®© Claude æŸ¥è¯¢
```

**3.4 æ£€æŸ¥ Token é™åˆ¶**
```
> /context

MCP Output Token Usage:
- postgres: 45,678 tokens âš ï¸ (limit: 25,000)
- Recommendation: Use LIMIT in queries

æç¤ºè¢«æˆªæ–­çš„è¿¹è±¡ï¼š
[... 1,234 more rows omitted due to token limit ...]
```

**3.5 éªŒè¯è¾“å…¥æ•°æ®**
```
å·¥å…·è°ƒç”¨å¤±è´¥åŸå› ï¼š
Parameters: {
  "user_id": "abc123"  â† åº”è¯¥æ˜¯æ•°å­—
}

æ•°æ®åº“æœŸæœ›ï¼šINTEGER
å®é™…ä¼ å…¥ï¼šSTRING

è§£å†³ï¼šåœ¨ Skill ä¸­æ·»åŠ ç±»å‹éªŒè¯è§„åˆ™
```

---

## ğŸ”’ å®‰å…¨åŠ å›ºä¸åˆè§„æ€§

### åŠ å›º 1ï¼šæœ€å°æƒé™åŸåˆ™

**åŸåˆ™ï¼š** åªæˆäºˆå®Œæˆä»»åŠ¡æ‰€éœ€çš„æœ€å°æƒé™ã€‚

**OAuth Scope æ§åˆ¶ï¼š**

âŒ **è¿‡åº¦æˆæƒï¼š**
```
GitHub Scopes:
- admin:org           â† ä¸éœ€è¦ç»„ç»‡ç®¡ç†æƒé™
- delete_repo         â† ä¸éœ€è¦åˆ é™¤ä»“åº“æƒé™
- admin:gpg_key       â† ä¸éœ€è¦ GPG key ç®¡ç†
```

âœ… **æœ€å°æƒé™ï¼š**
```
GitHub Scopes:
- repo                â† ä»“åº“è¯»å†™ï¼ˆå¿…éœ€ï¼‰
- read:user           â† è¯»å–ç”¨æˆ·ä¿¡æ¯ï¼ˆå¿…éœ€ï¼‰
```

**Filesystem Roots é™åˆ¶ï¼š**

âŒ **å±é™©ï¼š**
```json
{
  "filesystem": {
    "command": "filesystem-server",
    "args": ["/"]  // â† å…è®¸è®¿é—®æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿ
  }
}
```

âœ… **å®‰å…¨ï¼š**
```json
{
  "filesystem": {
    "command": "filesystem-server",
    "args": [
      "/project/data",      // åªå…è®¸é¡¹ç›®æ•°æ®ç›®å½•
      "/project/documents"  // å’Œæ–‡æ¡£ç›®å½•
    ]
  }
}
```

### åŠ å›º 2ï¼šæ•°æ®ä¿æŠ¤

**æ•æ„Ÿæ•°æ®è„±æ•ï¼š**

**æ–¹æ¡ˆ Aï¼šæœåŠ¡å™¨ç«¯è‡ªåŠ¨è„±æ•**
```javascript
// mcp-server.js
function sanitizeEmail(email) {
  const [user, domain] = email.split('@');
  return `${user[0]}***@${domain}`;
}

async function getUsers() {
  const users = await db.query("SELECT * FROM users");
  return users.map(user => ({
    ...user,
    email: sanitizeEmail(user.email),  // è‡ªåŠ¨è„±æ•
    phone: user.phone.replace(/\d(?=\d{4})/g, '*')
  }));
}
```

**æ–¹æ¡ˆ Bï¼šClaude æŒ‡ä»¤ï¼ˆSkillï¼‰**
```markdown
---
name: data-privacy
description: è‡ªåŠ¨ä¿æŠ¤æ•æ„Ÿæ•°æ®éšç§
---

# æ•°æ®éšç§ä¿æŠ¤è§„åˆ™

å¤„ç†ç”¨æˆ·æ•°æ®æ—¶ï¼Œå§‹ç»ˆéµå¾ªï¼š

## 1. ä¸ªäººèº«ä»½ä¿¡æ¯ (PII) è„±æ•
- é‚®ç®±ï¼š`user@example.com` â†’ `u***@example.com`
- ç”µè¯ï¼š`+1-555-1234` â†’ `+1-***-1234`
- åœ°å€ï¼šåªæ˜¾ç¤ºåŸå¸‚å’Œå›½å®¶ï¼Œéšè—è¡—é“

## 2. ä¸åœ¨å“åº”ä¸­åŒ…å«
- å¯†ç ï¼ˆå³ä½¿æ˜¯å“ˆå¸Œå€¼ï¼‰
- ä¿¡ç”¨å¡å·
- ç¤¾ä¼šå®‰å…¨å· (SSN)
- API å¯†é’¥å’Œ tokens

## 3. æ—¥å¿—è®°å½•
å½“è®°å½•æ“ä½œæ—¶ï¼Œä½¿ç”¨ç”¨æˆ· ID è€Œéé‚®ç®±æˆ–å§“åã€‚
```

### åŠ å›º 3ï¼šå®¡è®¡æ—¥å¿—

**è®°å½•æ‰€æœ‰ MCP æ“ä½œï¼š**

```javascript
// mcp-server.js
const fs = require('fs');

function auditLog(action, user, details) {
  const logEntry = {
    timestamp: new Date().toISOString(),
    action,
    user,
    details,
    ip: process.env.CLIENT_IP
  };

  fs.appendFileSync(
    '/var/log/mcp-audit.log',
    JSON.stringify(logEntry) + '\n'
  );
}

// ä½¿ç”¨
async function createPR(params) {
  auditLog('github_create_pr', 'claude-user', {
    repo: params.repo,
    title: params.title
  });

  // æ‰§è¡Œå®é™…æ“ä½œ
  const result = await github.createPR(params);
  return result;
}
```

**å®¡è®¡æ—¥å¿—æ ¼å¼ï¼š**
```json
{"timestamp":"2025-01-15T10:30:45Z","action":"github_create_pr","user":"alice@company.com","details":{"repo":"company/backend","title":"Fix auth bug"},"ip":"10.0.1.42"}
{"timestamp":"2025-01-15T10:31:12Z","action":"postgres_query","user":"alice@company.com","details":{"query":"SELECT * FROM users WHERE id = $1","params":[123]},"ip":"10.0.1.42"}
```

**åˆ†æå®¡è®¡æ—¥å¿—ï¼š**
```bash
# æŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„æ‰€æœ‰æ“ä½œ
cat /var/log/mcp-audit.log | jq 'select(.user == "alice@company.com")'

# æŸ¥æ‰¾æ•°æ®åº“æŸ¥è¯¢æ“ä½œ
cat /var/log/mcp-audit.log | jq 'select(.action == "postgres_query")'

# ç»Ÿè®¡æ“ä½œé¢‘ç‡
cat /var/log/mcp-audit.log | jq -r '.action' | sort | uniq -c
```

### åŠ å›º 4ï¼šåˆè§„æ€§æ£€æŸ¥

**GDPR åˆè§„ç¤ºä¾‹ï¼š**

```markdown
## MCP GDPR Compliance Checklist

### æ•°æ®æœ€å°åŒ–
- [ ] åªæ”¶é›†å¿…è¦çš„ç”¨æˆ·æ•°æ®
- [ ] MCP æŸ¥è¯¢ä½¿ç”¨ `SELECT` æŒ‡å®šåˆ—ï¼Œè€Œé `SELECT *`
- [ ] å®šæœŸæ¸…ç†ä¸å†éœ€è¦çš„æ•°æ®

### ç”¨æˆ·æƒåˆ©
- [ ] å®ç°"è®¿é—®æƒ"ï¼šç”¨æˆ·å¯ä»¥æŸ¥è¯¢è‡ªå·±çš„æ•°æ®
- [ ] å®ç°"åˆ é™¤æƒ"ï¼šç”¨æˆ·å¯ä»¥åˆ é™¤è‡ªå·±çš„æ•°æ®
- [ ] å®ç°"å¯¼å‡ºæƒ"ï¼šç”¨æˆ·å¯ä»¥å¯¼å‡ºæ•°æ®

### åŒæ„ç®¡ç†
- [ ] OAuth æµç¨‹æ˜ç¡®è¯´æ˜æ•°æ®ä½¿ç”¨æ–¹å¼
- [ ] ç”¨æˆ·å¯ä»¥æ’¤é”€æˆæƒ

### å®‰å…¨æªæ–½
- [ ] ä¼ è¾“åŠ å¯†ï¼ˆTLSï¼‰
- [ ] å­˜å‚¨åŠ å¯†ï¼ˆæ•°æ®åº“çº§åˆ«ï¼‰
- [ ] è®¿é—®æ§åˆ¶ï¼ˆæœ€å°æƒé™ï¼‰

### å®¡è®¡ä¸é€æ˜åº¦
- [ ] è®°å½•æ‰€æœ‰æ•°æ®è®¿é—®æ“ä½œ
- [ ] ä¿ç•™å®¡è®¡æ—¥å¿—è‡³å°‘ 1 å¹´
- [ ] æ•°æ®æ³„éœ²å“åº”è®¡åˆ’
```

**SOC 2 åˆè§„ç¤ºä¾‹ï¼š**

```json
// managed-mcp.jsonï¼ˆIT ç®¡ç†å‘˜ï¼‰
{
  "securityPolicies": {
    "requireMFA": true,
    "allowedIPs": ["10.0.0.0/8", "192.168.1.0/24"],
    "sessionTimeout": 3600,
    "requireApprovalForTools": [
      "mcp__*__delete*",
      "mcp__*__destroy*",
      "mcp__postgres__execute"
    ]
  },
  "auditLog": {
    "enabled": true,
    "destination": "syslog://audit.company.com:514",
    "retentionDays": 365
  }
}
```

---

## ğŸ“Š è´¨é‡æŒ‡æ ‡

### æŒ‡æ ‡ 1ï¼šMCP é›†æˆå¥åº·åº¦

**æ£€æŸ¥æ¸…å•ï¼š**

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹é‡æ–¹æ³• |
|------|------|---------|
| **è¿æ¥æˆåŠŸç‡** | > 99% | æ¯å°æ—¶ ping æµ‹è¯• |
| **å·¥å…·è°ƒç”¨æˆåŠŸç‡** | > 95% | æˆåŠŸè°ƒç”¨ / æ€»è°ƒç”¨ |
| **å¹³å‡å“åº”æ—¶é—´** | < 2 ç§’ | ç›‘æ§å·¥å…·è°ƒç”¨å»¶è¿Ÿ |
| **Token æ•ˆç‡** | < 5K tokens/query | `/context` å‘½ä»¤ç›‘æ§ |
| **é”™è¯¯ç‡** | < 5% | å¤±è´¥è°ƒç”¨ / æ€»è°ƒç”¨ |

**ç›‘æ§è„šæœ¬ï¼š**
```bash
#!/bin/bash
# mcp-health-check.sh

echo "MCP Health Check - $(date)"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# æµ‹è¯•æ‰€æœ‰æœåŠ¡å™¨è¿æ¥
claude -p "List all MCP servers and their status" --output json > /tmp/mcp_status.json

# è§£æç»“æœ
connected=$(jq '[.servers[] | select(.status == "connected")] | length' /tmp/mcp_status.json)
total=$(jq '.servers | length' /tmp/mcp_status.json)
success_rate=$(echo "scale=2; $connected / $total * 100" | bc)

echo "Connected: $connected / $total ($success_rate%)"

# è­¦æŠ¥
if (( $(echo "$success_rate < 95" | bc -l) )); then
  echo "âš ï¸  WARNING: Connection rate below 95%"
  # å‘é€å‘Šè­¦åˆ° Slack/PagerDuty
fi

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
```

### æŒ‡æ ‡ 2ï¼šå›¢é˜Ÿé‡‡ç”¨ç‡

**è·Ÿè¸ªæŒ‡æ ‡ï¼š**

```sql
-- æŸ¥è¯¢å›¢é˜Ÿæˆå‘˜çš„ MCP ä½¿ç”¨æƒ…å†µ
SELECT
  user_email,
  COUNT(DISTINCT server_name) as servers_used,
  COUNT(*) as total_tool_calls,
  AVG(execution_time_ms) as avg_response_time
FROM mcp_audit_log
WHERE timestamp > NOW() - INTERVAL '30 days'
GROUP BY user_email
ORDER BY total_tool_calls DESC;
```

**ç›®æ ‡ï¼š**
- 80% å›¢é˜Ÿæˆå‘˜ä½¿ç”¨è‡³å°‘ 1 ä¸ª MCP æœåŠ¡å™¨
- å¹³å‡æ¯äººä½¿ç”¨ 3+ ä¸ªæœåŠ¡å™¨
- æ¯å‘¨è‡³å°‘ 10 æ¬¡å·¥å…·è°ƒç”¨

---

## ğŸ¯ æœ¬èŠ‚æ ¸å¿ƒè¦ç‚¹

### 1. é…ç½®æŠ€å·§æ€»ç»“

| æŠ€å·§ | é€‚ç”¨åœºæ™¯ | å¤æ‚åº¦ |
|------|---------|-------|
| å¤šç¯å¢ƒç®¡ç† | å¼€å‘/æµ‹è¯•/ç”Ÿäº§ | ğŸŸ¡ ä¸­ |
| æ¡ä»¶é…ç½® | ç‰¹æ€§å¼€å…³ | ğŸŸ¢ ä½ |
| åˆ†å±‚ç»§æ‰¿ | ä¼ä¸š + å›¢é˜Ÿ + ä¸ªäºº | ğŸ”´ é«˜ |
| æ’ä»¶ç³»ç»Ÿ | å¯é‡ç”¨é…ç½®åŒ… | ğŸ”´ é«˜ |

### 2. æ€§èƒ½ä¼˜åŒ– Checklist

- [ ] Token é™åˆ¶ï¼š`MAX_MCP_OUTPUT_TOKENS=50000`
- [ ] æŸ¥è¯¢ä¼˜åŒ–ï¼šä½¿ç”¨ `LIMIT` å’Œ `WHERE`
- [ ] æ¸è¿›å¼åŠ è½½ï¼šåªåŠ è½½éœ€è¦çš„å·¥å…·
- [ ] ç»“æœç¼“å­˜ï¼šé¿å…é‡å¤æŸ¥è¯¢
- [ ] å¹¶è¡Œè°ƒç”¨ï¼šç‹¬ç«‹æ“ä½œåŒæ—¶æ‰§è¡Œ

### 3. å›¢é˜Ÿåä½œè¦ç‚¹

```
.mcp.json (æäº¤) + .env.example (æäº¤) + .env (ä¸æäº¤)
```

### 4. è°ƒè¯•ä¸‰çº§æ–¹æ³•

```
Level 1: è¿æ¥å’Œé…ç½® â†’ /mcp, jq, ç¯å¢ƒå˜é‡
Level 2: è®¤è¯å’Œæƒé™ â†’ OAuth, /permissions, ä¼ä¸šç­–ç•¥
Level 3: å·¥å…·æ‰§è¡Œ â†’ --mcp-debug, æ—¥å¿—, æ•°æ®éªŒè¯
```

### 5. å®‰å…¨åŸåˆ™

- âœ… æœ€å°æƒé™
- âœ… æ•°æ®è„±æ•
- âœ… å®¡è®¡æ—¥å¿—
- âœ… åˆè§„æ£€æŸ¥

---

## ğŸš€ ä¸‹ä¸€æ­¥

æ­å–œï¼ä½ å·²ç»æŒæ¡äº† MCP çš„é«˜çº§æŠ€å·§å’Œä¼ä¸šçº§æœ€ä½³å®è·µã€‚

åœ¨ **[3.5 æœ¬ç« å°ç»“](3.5-æœ¬ç« å°ç»“.md)** ä¸­ï¼Œæˆ‘ä»¬å°†ï¼š

- å›é¡¾ MCP çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹
- è§£ç­”å¸¸è§ç–‘é—®ï¼ˆFAQï¼‰
- æä¾›å¿«é€Ÿå‚è€ƒæŒ‡å—
- è§„åˆ’ä½ çš„ MCP å­¦ä¹ è·¯å¾„
- æŒ‡å‘ä¸‹ä¸€æ­¥çš„å­¦ä¹ èµ„æº

**å‡†å¤‡å¥½æ€»ç»“äº†å—ï¼Ÿ** è®©æˆ‘ä»¬å·©å›ºæ‰€å­¦çŸ¥è¯†ï¼

---

> ğŸ’¡ **å®è·µå»ºè®®ï¼š** é€‰æ‹©ä¸€ä¸ªä½ æœ€éœ€è¦çš„é«˜çº§æŠ€å·§ï¼ˆå¦‚å¤šç¯å¢ƒç®¡ç†æˆ–æ€§èƒ½ä¼˜åŒ–ï¼‰ï¼Œåœ¨ä½ çš„é¡¹ç›®ä¸­å®æ–½å®ƒã€‚çœŸæ­£çš„æŒæ¡æ¥è‡ªäºåº”ç”¨ï¼Œè€Œä¸ä»…ä»…æ˜¯ç†è§£ã€‚
