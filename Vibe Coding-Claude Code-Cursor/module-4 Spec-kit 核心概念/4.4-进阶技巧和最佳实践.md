# 4.4 è¿›é˜¶æŠ€å·§å’Œæœ€ä½³å®è·µ

## ğŸ¯ æœ¬ç« ç›®æ ‡

æœ¬ç« å°†æ·±å…¥æ¢è®¨ Spec-kit çš„é«˜çº§åº”ç”¨åœºæ™¯ï¼š
- âœ… å®ªæ³•æ¡†æ¶çš„æ·±åº¦åº”ç”¨
- âœ… å¥‘çº¦ä¼˜å…ˆå¼€å‘ï¼ˆContract-First Developmentï¼‰
- âœ… å¤šæŠ€æœ¯æ ˆå¹¶è¡Œæ¢ç´¢
- âœ… å›¢é˜Ÿåä½œæ¨¡å¼
- âœ… CI/CD é›†æˆ
- âœ… è°ƒè¯•ä¸æ•…éšœæ’æŸ¥

---

## ğŸ›ï¸ å®ªæ³•æ¡†æ¶æ·±åº¦åº”ç”¨

### ä»€ä¹ˆæ˜¯å®ªæ³•æ¡†æ¶ï¼Ÿ

**å®ªæ³•ï¼ˆConstitutionï¼‰** æ˜¯é¡¹ç›®çš„"ä¸å¯åå•†åŸåˆ™"ï¼Œç¡®ä¿æ‰€æœ‰å¼€å‘å†³ç­–ç¬¦åˆæ ¸å¿ƒä»·å€¼è§‚ã€‚

```markdown
å®ªæ³•çš„ä½œç”¨ï¼š
âœ… ç»Ÿä¸€å›¢é˜Ÿæ ‡å‡†ï¼ˆé¿å…"å„è‡ªä¸ºæ”¿"ï¼‰
âœ… è‡ªåŠ¨åŒ–è´¨é‡é—¨æ§ï¼ˆAI è‡ªåŠ¨éªŒè¯ï¼‰
âœ… é˜²æ­¢æŠ€æœ¯å€ºåŠ¡ï¼ˆå¤æ‚åº¦è¯æ˜æœºåˆ¶ï¼‰
âœ… åŠ é€Ÿå†³ç­–ï¼ˆæ˜ç¡®è¾¹ç•Œï¼‰
```

### ç»å…¸å®ªæ³•æ¡æ¬¾ç¤ºä¾‹

#### Article I: ç®€æ´ä¼˜å…ˆï¼ˆSimplicity Firstï¼‰

```markdown
# Article I: Simplicity First

**åŸåˆ™**: æ‰€æœ‰åŠŸèƒ½å¿…é¡»ä½¿ç”¨ â‰¤3 ä¸ªå¤–éƒ¨ä¾èµ–

**ç†ç”±**:
- å‡å°‘ç»´æŠ¤è´Ÿæ‹…
- é™ä½å®‰å…¨é£é™©
- æå‡é•¿æœŸå¯ç»´æŠ¤æ€§

**éªŒè¯æ–¹æ³•**:
```bash
# æ£€æŸ¥ Python é¡¹ç›®
cat requirements.txt | grep -v '^#' | grep -v '^$' | wc -l
# ç»“æœå¿…é¡» â‰¤ 3

# æ£€æŸ¥ Node.js é¡¹ç›®
jq '.dependencies | length' package.json
# ç»“æœå¿…é¡» â‰¤ 3
```

**è¿è§„å¤„ç†**:
- å¿…é¡»åœ¨ plan.md ä¸­è¯æ˜å¤æ‚åº¦åˆç†æ€§
- æä¾›ç®€åŒ–æ–¹æ¡ˆçš„è¯„ä¼°
- è®°å½•ä¸ºä»€ä¹ˆç®€å•æ–¹æ¡ˆä¸å¯è¡Œ

**ç¤ºä¾‹**:
âœ… åˆè§„: FastAPI (1 dep)
âœ… åˆè§„: FastAPI + SQLAlchemy + pytest (3 deps)
âŒ è¿è§„: FastAPI + SQLAlchemy + pytest + Redis + Celery (5 deps)
```

#### Article II: æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰

```markdown
# Article II: Test-Driven Development

**åŸåˆ™**: æ‰€æœ‰ä»£ç å¿…é¡»å…ˆå†™æµ‹è¯•å†å†™å®ç°

**ç†ç”±**:
- ç¡®ä¿å¯æµ‹è¯•æ€§
- é˜²æ­¢å›å½’
- æ–‡æ¡£åŒ–è¡Œä¸º

**éªŒè¯æ–¹æ³•**:
```bash
# Git æäº¤å†å²å¿…é¡»æ˜¾ç¤ºæµ‹è¯•å…ˆäºå®ç°
git log --oneline --grep="test" --grep="implement" --all

# æ­£ç¡®é¡ºåºï¼š
# abc123 Add failing test for user registration
# def456 Implement user registration to pass test

# é”™è¯¯é¡ºåºï¼š
# abc123 Implement user registration
# def456 Add tests for user registration âŒ
```

**å¼ºåˆ¶æ‰§è¡Œ**:
- Pre-commit hook æ£€æŸ¥æµ‹è¯•è¦†ç›–ç‡
- CI ç®¡é“è¦æ±‚æµ‹è¯•å…ˆäºå®ç°çš„æäº¤é¡ºåº
- Code review å¿…é¡»éªŒè¯ TDD æµç¨‹

**ç¤ºä¾‹**:
```python
# Step 1: å…ˆå†™æµ‹è¯•ï¼ˆä¼šå¤±è´¥ï¼‰
def test_user_registration():
    response = client.post("/api/users", json={
        "email": "test@example.com",
        "password": "SecurePass123"
    })
    assert response.status_code == 201
    assert "user_id" in response.json()

# Step 2: å®ç°åŠŸèƒ½ï¼ˆè®©æµ‹è¯•é€šè¿‡ï¼‰
@app.post("/api/users", status_code=201)
def register_user(user: UserCreate):
    # Implementation
    return {"user_id": 42}
```
```

#### Article III: å¥‘çº¦ä¼˜å…ˆï¼ˆContract-Firstï¼‰

```markdown
# Article III: Contract-First API Development

**åŸåˆ™**: æ‰€æœ‰ API å¿…é¡»å…ˆå®šä¹‰ OpenAPI è§„èŒƒå†å®ç°

**ç†ç”±**:
- å‰åç«¯å¹¶è¡Œå¼€å‘
- è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£
- å¥‘çº¦æµ‹è¯•ä¿è¯ä¸€è‡´æ€§

**éªŒè¯æ–¹æ³•**:
```bash
# æ£€æŸ¥ contracts/ ç›®å½•å¿…é¡»åœ¨å®ç°ä¹‹å‰åˆ›å»º
git log --diff-filter=A --find-renames --pretty=format:"%H %s" -- "specs/*/contracts/*.yaml"

# éªŒè¯å®ç°ç¬¦åˆå¥‘çº¦
openapi-spec-validator specs/001-feature/contracts/api.yaml
```

**å·¥ä½œæµ**:
1. äº§å“ç»ç† + åç«¯ + å‰ç«¯å…±åŒå®šä¹‰ OpenAPI å¥‘çº¦
2. å‰ç«¯åŸºäºå¥‘çº¦åˆ›å»º Mock æœåŠ¡å™¨
3. åç«¯åŸºäºå¥‘çº¦å®ç° API
4. é›†æˆæ—¶é›¶æƒŠå–œï¼ˆå¥‘çº¦ä¿è¯ä¸€è‡´æ€§ï¼‰

**å·¥å…·é“¾**:
```bash
# ä» OpenAPI ç”Ÿæˆ TypeScript ç±»å‹
npx openapi-typescript specs/001-feature/contracts/api.yaml -o types/api.ts

# ä» OpenAPI ç”Ÿæˆ Python Pydantic models
datamodel-code-generator --input api.yaml --output schemas.py

# åˆ›å»º Mock æœåŠ¡å™¨ï¼ˆå‰ç«¯å¼€å‘ç”¨ï¼‰
npx @stoplight/prism-cli mock specs/001-feature/contracts/api.yaml
```
```

#### Article IV: æ€§èƒ½é¢„ç®—ï¼ˆPerformance Budgetï¼‰

```markdown
# Article IV: Performance Budget

**åŸåˆ™**: æ‰€æœ‰åŠŸèƒ½å¿…é¡»æ»¡è¶³æ€§èƒ½é¢„ç®—

**é¢„ç®—æ ‡å‡†**:
| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹é‡æ–¹æ³• |
|------|------|----------|
| API å“åº”æ—¶é—´ | < 200ms (P95) | Load testing |
| é¡µé¢åŠ è½½æ—¶é—´ | < 2s (FCP) | Lighthouse |
| æ•°æ®åº“æŸ¥è¯¢ | < 50ms | Query profiling |
| Bundle å¤§å° | < 200KB (gzipped) | webpack-bundle-analyzer |

**éªŒè¯æ–¹æ³•**:
```bash
# API æ€§èƒ½æµ‹è¯•
ab -n 1000 -c 10 http://localhost:8000/api/endpoint

# å‰ç«¯æ€§èƒ½æµ‹è¯•
lighthouse https://example.com --only-categories=performance --chrome-flags="--headless"

# æ•°æ®åº“æŸ¥è¯¢åˆ†æ
EXPLAIN ANALYZE SELECT * FROM users WHERE email = 'test@example.com';
```

**è¶…é¢„ç®—å¤„ç†**:
- å¿…é¡»åœ¨ plan.md ä¸­è¯æ˜ä¸ºä»€ä¹ˆéœ€è¦è¶…é¢„ç®—
- æä¾›ä¼˜åŒ–æ–¹æ¡ˆå’Œæ—¶é—´è¡¨
- è®°å½•æ€§èƒ½ trade-off

**ç¤ºä¾‹**:
```markdown
## Performance Budget Justification

| Feature | Budget | Actual | Status | Justification |
|---------|--------|--------|--------|--------------|
| User Login | 200ms | 180ms | âœ… Pass | - |
| Photo Upload | 200ms | 350ms | âŒ Fail | Large file processing required |

### Photo Upload æ€§èƒ½è¯æ˜:
- ç®€åŒ–æ–¹æ¡ˆ: å®¢æˆ·ç«¯å‹ç¼©ï¼ˆrejected - ç§»åŠ¨ç«¯ CPU é™åˆ¶ï¼‰
- å½“å‰æ–¹æ¡ˆ: æœåŠ¡ç«¯å‹ç¼© + å¼‚æ­¥å¤„ç†
- ä¼˜åŒ–è®¡åˆ’:
  1. å¼•å…¥ CDNï¼ˆé¢„è®¡å‡å°‘ 100msï¼‰
  2. ä½¿ç”¨ WebAssembly å‹ç¼©ï¼ˆé¢„è®¡å‡å°‘ 50msï¼‰
  3. ç›®æ ‡: é™è‡³ 200ms ä»¥å†…ï¼ˆ2 å‘¨å†…å®Œæˆï¼‰
```
```

### å®ªæ³•çš„æ¼”è¿›

**ç‰ˆæœ¬ç®¡ç†ï¼š**
```markdown
# Project Constitution

**Version**: 2.1.0
**Ratified**: 2025-01-01
**Last Amended**: 2025-01-15

## Version History
- v2.1.0 (2025-01-15): Added Article V (Security Standards)
- v2.0.0 (2025-01-10): BREAKING - Changed Article I dependency limit from 5 to 3
- v1.1.0 (2025-01-05): Added Article IV (Performance Budget)
- v1.0.0 (2025-01-01): Initial constitution

## Amendment Process
1. Proposal: ä»»ä½•å›¢é˜Ÿæˆå‘˜å¯ä»¥æå‡ºä¿®æ­£æ¡ˆ
2. Discussion: å›¢é˜Ÿè®¨è®º (minimum 3 days)
3. Vote: éœ€è¦ 2/3 å¤šæ•°åŒæ„
4. Update: æ›´æ–° constitution.mdï¼Œå¢åŠ ç‰ˆæœ¬å·
5. Migrate: æ‰€æœ‰æ´»è·ƒ feature å¿…é¡»éªŒè¯æ–°å®ªæ³•åˆè§„æ€§
```

**å®ªæ³•å‡çº§å·¥ä½œæµï¼š**
```bash
# 1. å¤‡ä»½å½“å‰å®ªæ³•
cp .specify/memory/constitution.md .specify/memory/constitution.v1.0.0.md

# 2. æ›´æ–°å®ªæ³•
# ç¼–è¾‘ .specify/memory/constitution.md

# 3. éªŒè¯æ‰€æœ‰æ´»è·ƒ feature ç¬¦åˆæ–°å®ªæ³•
for feature in specs/*/; do
  echo "Validating $feature"
  /speckit.analyze --constitution-version=2.0.0 --feature=$feature
done

# 4. æäº¤å˜æ›´
git add .specify/memory/constitution.md
git commit -m "Constitution v2.0.0: Reduce dependency limit to 3

BREAKING CHANGE: Article I now requires â‰¤3 dependencies (was 5)

All active features validated against new constitution.
Features requiring adjustment: 003-analytics (pending refactor)"
```

---

## ğŸ“œ å¥‘çº¦ä¼˜å…ˆå¼€å‘ï¼ˆContract-First Developmentï¼‰

### æ ¸å¿ƒç†å¿µ

**ä¼ ç»Ÿæ–¹å¼ï¼š**
```
åç«¯å®ç° API â†’ å‰ç«¯å¯¹æ¥ â†’ å‘ç°ä¸ä¸€è‡´ â†’ è¿”å·¥
```

**å¥‘çº¦ä¼˜å…ˆæ–¹å¼ï¼š**
```
å®šä¹‰ OpenAPI å¥‘çº¦ â†’ å‰åç«¯å¹¶è¡Œå¼€å‘ â†’ é›†æˆé›¶æƒŠå–œ
```

### å®Œæ•´å·¥ä½œæµç¤ºä¾‹

#### Step 1: å®šä¹‰ OpenAPI å¥‘çº¦ï¼ˆå›¢é˜Ÿåä½œï¼‰

**å‚ä¸è§’è‰²ï¼š** äº§å“ç»ç†ã€åç«¯å¼€å‘ã€å‰ç«¯å¼€å‘ã€QA

```yaml
# specs/001-user-management/contracts/api.yaml
openapi: 3.0.0
info:
  title: User Management API
  version: 1.0.0

components:
  schemas:
    User:
      type: object
      required: [id, email, name]
      properties:
        id:
          type: integer
          example: 42
        email:
          type: string
          format: email
          example: user@example.com
        name:
          type: string
          minLength: 1
          maxLength: 100
          example: John Doe
        created_at:
          type: string
          format: date-time
          example: "2025-01-15T10:30:00Z"

paths:
  /api/users:
    get:
      summary: List users
      operationId: listUsers
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: per_page
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
      responses:
        '200':
          description: User list
          content:
            application/json:
              schema:
                type: object
                properties:
                  users:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  total:
                    type: integer
                  page:
                    type: integer
                  per_page:
                    type: integer

    post:
      summary: Create user
      operationId: createUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, name, password]
              properties:
                email:
                  type: string
                  format: email
                name:
                  type: string
                  minLength: 1
                password:
                  type: string
                  format: password
                  minLength: 8
      responses:
        '201':
          description: User created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Validation error
        '409':
          description: Email already exists
```

#### Step 2: éªŒè¯å¥‘çº¦åˆæ³•æ€§

```bash
# å®‰è£…éªŒè¯å·¥å…·
npm install -g @apidevtools/swagger-cli

# éªŒè¯ OpenAPI è§„èŒƒ
swagger-cli validate specs/001-user-management/contracts/api.yaml

# è¾“å‡ºï¼š
# specs/001-user-management/contracts/api.yaml is valid âœ…
```

#### Step 3: å‰ç«¯å¹¶è¡Œå¼€å‘ï¼ˆä½¿ç”¨ Mock æœåŠ¡å™¨ï¼‰

```bash
# å¯åŠ¨ Mock æœåŠ¡å™¨ï¼ˆè‡ªåŠ¨åŸºäº OpenAPI ç”Ÿæˆï¼‰
npx @stoplight/prism-cli mock specs/001-user-management/contracts/api.yaml

# è¾“å‡ºï¼š
# [Prism] Server is running on http://127.0.0.1:4010
```

**å‰ç«¯ä»£ç ï¼ˆç«‹å³å¼€å§‹å¼€å‘ï¼‰ï¼š**
```typescript
// frontend/src/api/users.ts
import axios from 'axios';

// ä½¿ç”¨ Mock æœåŠ¡å™¨
const API_BASE = process.env.NODE_ENV === 'development'
  ? 'http://127.0.0.1:4010'  // Mock server
  : 'https://api.production.com';  // Real API

interface User {
  id: number;
  email: string;
  name: string;
  created_at: string;
}

interface UserListResponse {
  users: User[];
  total: number;
  page: number;
  per_page: number;
}

export async function listUsers(page = 1, perPage = 20): Promise<UserListResponse> {
  const response = await axios.get(`${API_BASE}/api/users`, {
    params: { page, per_page: perPage }
  });
  return response.data;
}

export async function createUser(email: string, name: string, password: string): Promise<User> {
  const response = await axios.post(`${API_BASE}/api/users`, {
    email,
    name,
    password
  });
  return response.data;
}

// å‰ç«¯å¯ä»¥ç«‹å³å¼€å‘ UIï¼Œæ— éœ€ç­‰å¾…åç«¯ï¼
```

#### Step 4: åç«¯å¹¶è¡Œå¼€å‘ï¼ˆåŸºäºå¥‘çº¦å®ç°ï¼‰

```python
# backend/src/schemas.py
# ä» OpenAPI è‡ªåŠ¨ç”Ÿæˆ Pydantic models
from pydantic import BaseModel, EmailStr, Field
from datetime import datetime

class UserResponse(BaseModel):
    id: int
    email: EmailStr
    name: str = Field(..., min_length=1, max_length=100)
    created_at: datetime

class UserCreate(BaseModel):
    email: EmailStr
    name: str = Field(..., min_length=1, max_length=100)
    password: str = Field(..., min_length=8)

class UserListResponse(BaseModel):
    users: list[UserResponse]
    total: int
    page: int
    per_page: int
```

```python
# backend/src/api/users.py
from fastapi import APIRouter, HTTPException, Query
from src.schemas import UserResponse, UserCreate, UserListResponse
from src.models import User
from src.database import get_db

router = APIRouter(prefix="/api", tags=["Users"])

@router.get("/users", response_model=UserListResponse)
async def list_users(
    page: int = Query(1, ge=1),
    per_page: int = Query(20, ge=1, le=100),
    db=Depends(get_db)
):
    """
    List users with pagination.

    Implements: GET /api/users from OpenAPI contract
    """
    offset = (page - 1) * per_page
    users = db.query(User).offset(offset).limit(per_page).all()
    total = db.query(User).count()

    return UserListResponse(
        users=users,
        total=total,
        page=page,
        per_page=per_page
    )

@router.post("/users", response_model=UserResponse, status_code=201)
async def create_user(user_data: UserCreate, db=Depends(get_db)):
    """
    Create a new user.

    Implements: POST /api/users from OpenAPI contract
    """
    # Check email uniqueness
    existing = db.query(User).filter(User.email == user_data.email).first()
    if existing:
        raise HTTPException(status_code=409, detail="Email already exists")

    # Hash password
    hashed_password = hash_password(user_data.password)

    # Create user
    user = User(
        email=user_data.email,
        name=user_data.name,
        password_hash=hashed_password
    )
    db.add(user)
    db.commit()
    db.refresh(user)

    return user
```

#### Step 5: å¥‘çº¦æµ‹è¯•ï¼ˆéªŒè¯å®ç°ç¬¦åˆå¥‘çº¦ï¼‰

```python
# backend/tests/test_contract_compliance.py
import pytest
from fastapi.testclient import TestClient
from openapi_core import create_spec
from openapi_core.validation.request import openapi_request_validator
from openapi_core.validation.response import openapi_response_validator

@pytest.fixture
def openapi_spec():
    with open('specs/001-user-management/contracts/api.yaml') as f:
        return create_spec(yaml.safe_load(f))

def test_list_users_contract(client: TestClient, openapi_spec):
    """éªŒè¯ GET /api/users å®ç°ç¬¦åˆå¥‘çº¦"""
    response = client.get("/api/users?page=1&per_page=10")

    # éªŒè¯å“åº”ç»“æ„ç¬¦åˆ OpenAPI schema
    validator = openapi_response_validator(openapi_spec)
    result = validator.validate(response)

    assert result.errors == []  # æ— éªŒè¯é”™è¯¯
    assert response.status_code == 200

    data = response.json()
    assert "users" in data
    assert "total" in data
    assert isinstance(data["users"], list)

def test_create_user_contract(client: TestClient, openapi_spec):
    """éªŒè¯ POST /api/users å®ç°ç¬¦åˆå¥‘çº¦"""
    response = client.post("/api/users", json={
        "email": "test@example.com",
        "name": "Test User",
        "password": "SecurePass123"
    })

    # éªŒè¯å“åº”ç¬¦åˆå¥‘çº¦
    validator = openapi_response_validator(openapi_spec)
    result = validator.validate(response)

    assert result.errors == []
    assert response.status_code == 201

    data = response.json()
    assert "id" in data
    assert data["email"] == "test@example.com"
```

#### Step 6: é›†æˆï¼ˆå‰åç«¯å¯¹æ¥ï¼‰

```typescript
// å‰ç«¯åˆ‡æ¢åˆ°çœŸå® API
const API_BASE = 'https://api.production.com';  // ä» Mock åˆ‡æ¢åˆ°çœŸå®

// ç”±äºéƒ½éµå¾ªåŒä¸€ä¸ª OpenAPI å¥‘çº¦ï¼Œé›†æˆæ—¶é›¶æƒŠå–œï¼
```

**å¥‘çº¦ä¼˜å…ˆçš„ä»·å€¼ï¼š**
```
èŠ‚çœæ—¶é—´ï¼šå‰åç«¯å¹¶è¡Œå¼€å‘ï¼ŒèŠ‚çœ 40-60% æ—¶é—´
å‡å°‘ bugï¼šå¥‘çº¦ä¿è¯ä¸€è‡´æ€§ï¼Œé›†æˆ bug å‡å°‘ 80%
è‡ªåŠ¨æ–‡æ¡£ï¼šOpenAPI è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ï¼Œæ°¸è¿œæœ€æ–°
ç±»å‹å®‰å…¨ï¼šè‡ªåŠ¨ç”Ÿæˆç±»å‹å®šä¹‰ï¼Œç¼–è¯‘æ—¶å‘ç°é”™è¯¯
```

---

## ğŸŒ² å¤šæŠ€æœ¯æ ˆå¹¶è¡Œæ¢ç´¢

### ä½¿ç”¨åœºæ™¯

åˆ›ä¸šå›¢é˜Ÿä¸ç¡®å®šæœ€ä½³æŠ€æœ¯æ ˆæ—¶ï¼Œå¯ä»¥ä»**åŒä¸€ä»½è§„æ ¼**ç”Ÿæˆå¤šä¸ªå®ç°ï¼Œå¯¹æ¯”åé€‰æ‹©æœ€ä¼˜æ–¹æ¡ˆã€‚

### å®Œæ•´æ¡ˆä¾‹ï¼šä»ªè¡¨ç›˜é¡¹ç›®

#### Step 1: ç¼–å†™æŠ€æœ¯æ— å…³çš„è§„æ ¼

```bash
/speckit.specify ç”¨æˆ·ä»ªè¡¨ç›˜ï¼Œæ˜¾ç¤ºä»»åŠ¡ç»Ÿè®¡ã€æœ€è¿‘æ´»åŠ¨ã€å¿«é€Ÿæ“ä½œ
```

**ç”Ÿæˆ specs/001-dashboard/spec.md**ï¼ˆæŠ€æœ¯æ— å…³ï¼‰ï¼š
```markdown
## User Scenarios

### P1: ä»»åŠ¡ç»Ÿè®¡æ¦‚è§ˆ
- Given ç”¨æˆ·ç™»å½•ç³»ç»Ÿ
- When è®¿é—®ä»ªè¡¨ç›˜
- Then æ˜¾ç¤ºï¼š
  - å¾…åŠä»»åŠ¡æ•°é‡
  - å·²å®Œæˆä»»åŠ¡æ•°é‡
  - ä»Šæ—¥æ–°å¢ä»»åŠ¡
  - æœ¬å‘¨å®Œæˆç‡è¶‹åŠ¿å›¾

### P2: æœ€è¿‘æ´»åŠ¨æµ
- Given ç”¨æˆ·æœ‰æ“ä½œè®°å½•
- When æ»šåŠ¨ä»ªè¡¨ç›˜
- Then æ˜¾ç¤ºæœ€è¿‘ 10 æ¡æ´»åŠ¨ï¼ˆåˆ›å»ºã€å®Œæˆã€åˆ é™¤ä»»åŠ¡ï¼‰
- And æ¯æ¡æ´»åŠ¨æ˜¾ç¤ºï¼šå›¾æ ‡ã€æè¿°ã€æ—¶é—´æˆ³

## Success Criteria
- SC-001: ä»ªè¡¨ç›˜åŠ è½½ < 1 second
- SC-002: æ”¯æŒ 1000+ ä»»åŠ¡æ— æ€§èƒ½ä¸‹é™
- SC-003: å®æ—¶æ›´æ–°ï¼ˆWebSocketï¼‰
```

#### Step 2: ç”Ÿæˆ 3 ä¸ªå¹¶è¡ŒæŠ€æœ¯æ–¹æ¡ˆ

**æ–¹æ¡ˆ A: React + Node.js + MongoDB**
```bash
/speckit.plan React 18 + TypeScript + Node.js Express + MongoDB + Socket.io
```

**å…³é”®æŠ€æœ¯å†³ç­–ï¼ˆplan-react-node.mdï¼‰ï¼š**
```markdown
## Technical Context
- Frontend: React 18 + TypeScript + Vite
- Backend: Node.js 20 + Express 4
- Database: MongoDB 6
- Real-time: Socket.io
- State: Zustand

## ä¼˜åŠ¿
âœ… å…¨æ ˆ JavaScriptï¼ˆå­¦ä¹ æ›²çº¿ä½ï¼‰
âœ… MongoDB çµæ´» schemaï¼ˆé€‚åˆå¿«é€Ÿè¿­ä»£ï¼‰
âœ… Socket.io å¼€ç®±å³ç”¨

## åŠ£åŠ¿
âŒ MongoDB æ— äº‹åŠ¡ï¼ˆå¤æ‚æŸ¥è¯¢å¼±ï¼‰
âŒ Node.js å•çº¿ç¨‹ï¼ˆCPU å¯†é›†å‹å·®ï¼‰
```

**æ–¹æ¡ˆ B: Vue + Python + PostgreSQL**
```bash
/speckit.plan Vue 3 + TypeScript + Python FastAPI + PostgreSQL + Server-Sent Events
```

**å…³é”®æŠ€æœ¯å†³ç­–ï¼ˆplan-vue-python.mdï¼‰ï¼š**
```markdown
## Technical Context
- Frontend: Vue 3 + TypeScript + Vite
- Backend: Python 3.11 + FastAPI
- Database: PostgreSQL 15
- Real-time: Server-Sent Events (SSE)
- State: Pinia

## ä¼˜åŠ¿
âœ… PostgreSQL å¼ºå¤§æŸ¥è¯¢èƒ½åŠ›
âœ… FastAPI é«˜æ€§èƒ½ï¼ˆStarlette + Pydanticï¼‰
âœ… Python ç”Ÿæ€ä¸°å¯Œï¼ˆæ•°æ®åˆ†æï¼‰

## åŠ£åŠ¿
âŒ SSE å•å‘é€šä¿¡ï¼ˆéœ€è¦ polling è¡¥å……ï¼‰
âŒ Python éƒ¨ç½²å¤æ‚åº¦é«˜
```

**æ–¹æ¡ˆ C: Svelte + Go + SQLite**
```bash
/speckit.plan Svelte + Go + SQLite + WebSocket
```

**å…³é”®æŠ€æœ¯å†³ç­–ï¼ˆplan-svelte-go.mdï¼‰ï¼š**
```markdown
## Technical Context
- Frontend: Svelte 4 + TypeScript
- Backend: Go 1.21 + Gin
- Database: SQLite 3
- Real-time: Gorilla WebSocket
- Deployment: Single binary

## ä¼˜åŠ¿
âœ… æè‡´æ€§èƒ½ï¼ˆGo + Svelte ç¼–è¯‘ä¼˜åŒ–ï¼‰
âœ… éƒ¨ç½²ç®€å•ï¼ˆå•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼‰
âœ… SQLite é›¶é…ç½®ï¼ˆåµŒå…¥å¼æ•°æ®åº“ï¼‰

## åŠ£åŠ¿
âŒ SQLite å¹¶å‘å†™é™åˆ¶ï¼ˆå¤šç”¨æˆ·åœºæ™¯å¼±ï¼‰
âŒ Go ç”Ÿæ€è¾ƒå°ï¼ˆåº“ä¸å¦‚ Python/Nodeä¸°å¯Œï¼‰
```

#### Step 3: å¹¶è¡Œå®ç°ï¼ˆ3 ä¸ªå¼€å‘è€…ï¼‰

```bash
# å¼€å‘è€… A
cd implementations/react-node
/speckit.tasks --plan=../../specs/001-dashboard/plan-react-node.md
/speckit.implement

# å¼€å‘è€… B
cd implementations/vue-python
/speckit.tasks --plan=../../specs/001-dashboard/plan-vue-python.md
/speckit.implement

# å¼€å‘è€… C
cd implementations/svelte-go
/speckit.tasks --plan=../../specs/001-dashboard/plan-svelte-go.md
/speckit.implement
```

#### Step 4: åŸºå‡†æµ‹è¯•å¯¹æ¯”

**æ€§èƒ½æµ‹è¯•è„šæœ¬ï¼š**
```bash
#!/bin/bash
# benchmark.sh

echo "=== æ€§èƒ½åŸºå‡†æµ‹è¯• ==="

# æµ‹è¯• 1: å†·å¯åŠ¨æ—¶é—´
echo "å†·å¯åŠ¨æ—¶é—´:"
for impl in react-node vue-python svelte-go; do
  cd implementations/$impl
  time curl -s http://localhost:3000/api/dashboard > /dev/null
  cd ../..
done

# æµ‹è¯• 2: ååé‡ (1000 requests)
echo "ååé‡æµ‹è¯•:"
ab -n 1000 -c 10 http://localhost:3000/api/dashboard

# æµ‹è¯• 3: å†…å­˜ä½¿ç”¨
echo "å†…å­˜ä½¿ç”¨:"
ps aux | grep "node\|python\|go-app"

# æµ‹è¯• 4: Bundle å¤§å°
echo "å‰ç«¯ Bundle å¤§å°:"
du -sh implementations/*/dist
```

**æµ‹è¯•ç»“æœï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®ç°æ–¹æ¡ˆ     â”‚ å†·å¯åŠ¨   â”‚ ååé‡  â”‚ å†…å­˜   â”‚ Bundle   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ React+Node  â”‚ 850ms    â”‚ 450 RPS â”‚ 180MB  â”‚ 245KB    â”‚
â”‚ Vue+Python  â”‚ 320ms    â”‚ 1200RPS â”‚ 95MB   â”‚ 180KB    â”‚
â”‚ Svelte+Go   â”‚ 120ms    â”‚ 2500RPS â”‚ 25MB   â”‚ 85KB     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç»“è®ºï¼šSvelte + Go åœ¨æ‰€æœ‰æŒ‡æ ‡ä¸Šé¢†å…ˆ
```

#### Step 5: å¼€å‘ä½“éªŒå¯¹æ¯”

**å¼€å‘è€…åé¦ˆï¼š**
```markdown
| ç»´åº¦ | React+Node | Vue+Python | Svelte+Go |
|------|-----------|-----------|----------|
| å­¦ä¹ æ›²çº¿ | â­â­â­â­ | â­â­â­ | â­â­ |
| å¼€å‘é€Ÿåº¦ | â­â­â­ | â­â­â­â­ | â­â­â­ |
| è°ƒè¯•ä½“éªŒ | â­â­â­â­ | â­â­â­â­ | â­â­â­ |
| ç”Ÿæ€ä¸°å¯Œåº¦ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­ |
| éƒ¨ç½²éš¾åº¦ | â­â­â­ | â­â­ | â­â­â­â­â­ |

å¼€å‘è€… A: "React ç”Ÿæ€æœ€æˆç†Ÿï¼Œä½† bundle å¤ªå¤§"
å¼€å‘è€… B: "Python å¼€å‘æœ€å¿«ï¼ŒFastAPI å¾ˆçˆ½"
å¼€å‘è€… C: "Go æ€§èƒ½æ— æ•Œï¼Œéƒ¨ç½²è¶…ç®€å•ï¼Œä½†åº“å°‘ä¸€äº›"
```

#### Step 6: æœ€ç»ˆå†³ç­–

**å†³ç­–çŸ©é˜µï¼š**
```markdown
ä¼˜å…ˆçº§æƒé‡ï¼š
- æ€§èƒ½: 40%ï¼ˆæ ¸å¿ƒéœ€æ±‚ï¼‰
- å¼€å‘é€Ÿåº¦: 30%
- éƒ¨ç½²ç®€æ˜“: 20%
- ç”Ÿæ€: 10%

åŠ æƒå¾—åˆ†ï¼š
- React+Node: 2.8 / 5.0
- Vue+Python: 3.6 / 5.0  â† æ¨è
- Svelte+Go: 3.9 / 5.0   â† **æœ€ç»ˆé€‰æ‹©**

æœ€ç»ˆé€‰æ‹©ï¼šSvelte + Go
ç†ç”±ï¼šæ€§èƒ½ä¼˜åŠ¿æ˜æ˜¾ï¼Œéƒ¨ç½²æç®€ï¼Œå­¦ä¹ æ›²çº¿å¯æ¥å—
```

**ä¿ç•™æ–¹æ¡ˆï¼š** Vue + Python ä½œä¸ºå¤‡é€‰ï¼ˆå¦‚æœ Go ç”Ÿæ€ä¸è¶³æ—¶åˆ‡æ¢ï¼‰

---

## ğŸ‘¥ å›¢é˜Ÿåä½œæ¨¡å¼

### æ¨¡å¼ 1ï¼šè§„æ ¼å…ˆè¡Œåä½œ

**è§’è‰²åˆ†å·¥ï¼š**
```
äº§å“ç»ç† â†’ ç¼–å†™ spec.mdï¼ˆWhat & Whyï¼‰
    â†“
æŠ€æœ¯è´Ÿè´£äºº â†’ Review specï¼Œæå‡ºæ¾„æ¸…é—®é¢˜
    â†“
äº§å“ç»ç† â†’ æ¾„æ¸…ï¼ˆ/speckit.clarifyï¼‰
    â†“
åç«¯å›¢é˜Ÿ â†’ ç”Ÿæˆ plan.mdï¼ˆåç«¯æŠ€æœ¯æ ˆï¼‰
å‰ç«¯å›¢é˜Ÿ â†’ ç”Ÿæˆ plan.mdï¼ˆå‰ç«¯æŠ€æœ¯æ ˆï¼‰
    â†“ï¼ˆå¹¶è¡Œå¼€å‘ï¼‰
åç«¯ â†’ å®ç° API
å‰ç«¯ â†’ å®ç° UI
    â†“
é›†æˆæµ‹è¯• â†’ éªŒè¯åŠŸèƒ½
```

**Git å·¥ä½œæµï¼š**
```bash
# 1. äº§å“ç»ç†åˆ›å»º spec
git checkout -b 001-user-dashboard
/speckit.specify ç”¨æˆ·ä»ªè¡¨ç›˜åŠŸèƒ½
git add specs/001-user-dashboard/spec.md
git commit -m "spec: Add user dashboard specification"
git push origin 001-user-dashboard

# 2. æŠ€æœ¯è´Ÿè´£äºº Review
gh pr create --title "Spec: User Dashboard" --body "Please review specification"
# Team reviews in GitHub PR comments

# 3. æ¾„æ¸…åï¼Œäº§å“ç»ç†æ›´æ–° spec
/speckit.clarify
git add specs/001-user-dashboard/spec.md
git commit -m "spec: Clarify real-time update requirements"
git push

# 4. åç«¯å›¢é˜Ÿåˆ›å»º plan
git checkout 001-user-dashboard
/speckit.plan FastAPI + PostgreSQL + WebSocket
git add specs/001-user-dashboard/plan-backend.md
git commit -m "plan: Backend technical design"
git push

# 5. å‰ç«¯å›¢é˜Ÿåˆ›å»º planï¼ˆåŸºäºåŒä¸€ä¸ª specï¼‰
/speckit.plan React + TypeScript + Socket.io
git add specs/001-user-dashboard/plan-frontend.md
git commit -m "plan: Frontend technical design"
git push

# 6. å¹¶è¡Œå®ç°
# åç«¯å›¢é˜Ÿ
cd backend
/speckit.tasks --plan=../specs/001-user-dashboard/plan-backend.md
/speckit.implement
git add backend/
git commit -m "feat: Implement user dashboard API"

# å‰ç«¯å›¢é˜Ÿï¼ˆåŒæ—¶è¿›è¡Œï¼‰
cd frontend
/speckit.tasks --plan=../specs/001-user-dashboard/plan-frontend.md
/speckit.implement
git add frontend/
git commit -m "feat: Implement user dashboard UI"

# 7. é›†æˆ
git merge 001-user-dashboard
# ç”±äºéƒ½åŸºäºåŒä¸€ä¸ª spec + å¥‘çº¦ï¼Œé›†æˆé¡ºåˆ©
```

### æ¨¡å¼ 2ï¼šå®ªæ³•é©±åŠ¨æ ‡å‡†åŒ–

**å›¢é˜Ÿå®ªæ³•ç¤ºä¾‹ï¼š**
```markdown
# Team Constitution v2.0

## Article I: Code Review æ ‡å‡†
æ‰€æœ‰ä»£ç å¿…é¡»é€šè¿‡è‡³å°‘ 2 äºº review

**éªŒè¯æ–¹æ³•**:
```bash
# GitHub branch protection rules
gh api repos/:owner/:repo/branches/main/protection \
  --field required_pull_request_reviews[required_approving_review_count]=2
```

## Article II: æµ‹è¯•è¦†ç›–ç‡
æ‰€æœ‰æ–°ä»£ç æµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%

**éªŒè¯æ–¹æ³•**:
```bash
# CI pipeline
pytest --cov=src --cov-report=term --cov-fail-under=80
```

## Article III: å®‰å…¨æ‰«æ
æ‰€æœ‰ä¾èµ–å¿…é¡»é€šè¿‡å®‰å…¨æ‰«æ

**éªŒè¯æ–¹æ³•**:
```bash
# CI pipeline
npm audit --audit-level=high
safety check --json
```

## Article IV: æ€§èƒ½é¢„ç®—
æ‰€æœ‰ API å“åº” < 200ms (P95)

**éªŒè¯æ–¹æ³•**:
```bash
# Load testing in CI
k6 run performance-test.js
```
```

**CI/CD é›†æˆï¼ˆè‡ªåŠ¨éªŒè¯å®ªæ³•ï¼‰ï¼š**
```yaml
# .github/workflows/constitution-check.yml
name: Constitution Compliance

on:
  pull_request:
    branches: [main]

jobs:
  check-constitution:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Article I - Verify PR approvals
        run: |
          approvals=$(gh pr view ${{ github.event.pull_request.number }} --json reviews --jq '.reviews | length')
          if [ "$approvals" -lt 2 ]; then
            echo "âŒ Article I violated: Need 2 approvals, got $approvals"
            exit 1
          fi

      - name: Article II - Test coverage
        run: |
          pytest --cov=src --cov-report=term --cov-fail-under=80

      - name: Article III - Security scan
        run: |
          npm audit --audit-level=high
          safety check

      - name: Article IV - Performance test
        run: |
          k6 run --quiet performance-test.js
          # Fails if P95 > 200ms
```

---

## ğŸš€ CI/CD é›†æˆ

### å®Œæ•´ CI/CD ç®¡é“

```yaml
# .github/workflows/spec-driven-pipeline.yml
name: Spec-Driven CI/CD

on:
  push:
    branches: [main]
    paths:
      - 'specs/**'
      - 'src/**'
      - 'tests/**'

jobs:
  validate-spec:
    name: Validate Specification
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Install Spec-kit
        run: |
          pip install uv
          uv tool install specify-cli --from git+https://github.com/github/spec-kit.git

      - name: Validate against constitution
        run: |
          # æ£€æŸ¥æ‰€æœ‰ spec ç¬¦åˆå®ªæ³•
          for spec in specs/*/spec.md; do
            echo "Validating $spec"
            specify analyze --spec=$spec --constitution=.specify/memory/constitution.md
          done

      - name: Verify OpenAPI contracts
        run: |
          npm install -g @apidevtools/swagger-cli
          for contract in specs/*/contracts/*.yaml; do
            swagger-cli validate $contract
          done

  test-backend:
    name: Backend Tests
    needs: validate-spec
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          pip install -r backend/requirements.txt
          pip install pytest pytest-cov

      - name: Run tests
        run: |
          cd backend
          pytest --cov=src --cov-report=xml --cov-fail-under=80

      - name: Contract compliance tests
        run: |
          # éªŒè¯å®ç°ç¬¦åˆ OpenAPI å¥‘çº¦
          pytest tests/test_contract_compliance.py

      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          file: ./backend/coverage.xml

  test-frontend:
    name: Frontend Tests
    needs: validate-spec
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Install dependencies
        run: |
          cd frontend
          npm ci

      - name: Run tests
        run: |
          cd frontend
          npm run test:coverage

      - name: Build
        run: |
          cd frontend
          npm run build

      - name: Check bundle size
        run: |
          cd frontend
          size=$(du -sb dist | awk '{print $1}')
          max_size=$((200 * 1024))  # 200KB
          if [ $size -gt $max_size ]; then
            echo "âŒ Bundle too large: ${size}B > ${max_size}B"
            exit 1
          fi

  performance-test:
    name: Performance Testing
    needs: [test-backend, test-frontend]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Setup services
        run: |
          docker-compose -f docker-compose.test.yml up -d
          sleep 10  # Wait for services to be ready

      - name: Install k6
        run: |
          sudo gpg -k
          sudo gpg --no-default-keyring --keyring /usr/share/keyrings/k6-archive-keyring.gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys C5AD17C747E3415A3642D57D77C6C491D6AC1D69
          echo "deb [signed-by=/usr/share/keyrings/k6-archive-keyring.gpg] https://dl.k6.io/deb stable main" | sudo tee /etc/apt/sources.list.d/k6.list
          sudo apt-get update
          sudo apt-get install k6

      - name: Run load tests
        run: |
          k6 run --quiet performance/load-test.js
          # Fails if metrics don't meet constitution requirements

  deploy-staging:
    name: Deploy to Staging
    needs: [test-backend, test-frontend, performance-test]
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Deploy backend
        run: |
          # Deploy to staging environment
          ./scripts/deploy-staging.sh backend

      - name: Deploy frontend
        run: |
          ./scripts/deploy-staging.sh frontend

      - name: Smoke tests
        run: |
          # Verify deployment
          curl -f https://staging.example.com/health || exit 1
          curl -f https://staging.example.com/ || exit 1
```

---

## ğŸ› è°ƒè¯•ä¸æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜ 1: Spec ä¸ Plan ä¸ä¸€è‡´

**ç—‡çŠ¶ï¼š**
```
å®ç°çš„åŠŸèƒ½ä¸ spec.md æè¿°ä¸ç¬¦
```

**æ’æŸ¥æ–¹æ³•ï¼š**
```bash
# è¿è¡Œä¸€è‡´æ€§æ£€æŸ¥
/speckit.analyze

# è¾“å‡ºï¼š
# âŒ Inconsistency detected:
# - spec.md requires "User can filter by tags"
# - plan.md does not mention tag filtering
# - tasks.md has no tag-related tasks
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ›´æ–° plan åŒ…å«é—æ¼çš„åŠŸèƒ½
/speckit.plan [é‡æ–°ç”Ÿæˆï¼ŒåŒ…å«æ ‡ç­¾è¿‡æ»¤]

# æ›´æ–° tasks
/speckit.tasks

# é‡æ–°å®ç°
/speckit.implement
```

---

### å¸¸è§é—®é¢˜ 2: å®ªæ³•è¿è§„

**ç—‡çŠ¶ï¼š**
```
plan.md ä¸­ä½¿ç”¨äº† 5 ä¸ªä¾èµ–ï¼Œè¿åå®ªæ³•ï¼ˆâ‰¤3ï¼‰
```

**æ’æŸ¥æ–¹æ³•ï¼š**
```bash
# æ£€æŸ¥ä¾èµ–æ•°é‡
grep "^dependencies:" plan.md -A 10 | wc -l

# è¾“å‡ºï¼š5 âŒï¼ˆè¿è§„ï¼‰
```

**è§£å†³æ–¹æ¡ˆï¼š**
```markdown
## Complexity Justificationï¼ˆåœ¨ plan.md ä¸­æ·»åŠ ï¼‰

| Dependency | Justification | Simpler Alternative | Why Rejected |
|------------|---------------|---------------------|--------------|
| FastAPI | Web framework | Flask | FastAPI async performance needed |
| SQLAlchemy | ORM | Raw SQL | Complex queries, migrations |
| Pytest | Testing | unittest | Better fixtures, plugins |
| Redis | Caching | In-memory | Distributed deployment requirement |
| Celery | Task queue | Threading | Requires distributed workers |

**Total Dependencies**: 5
**Constitution Limit**: 3
**Approval Required**: Yes

**Mitigation Plan**:
1. Phase 1: Ship with 5 deps (approved violation)
2. Phase 2 (Q2 2025): Replace Celery with lightweight alternative
3. Target: Reduce to 4 deps by Q2, 3 deps by Q3
```

---

### å¸¸è§é—®é¢˜ 3: å¥‘çº¦æµ‹è¯•å¤±è´¥

**ç—‡çŠ¶ï¼š**
```
Contract test failed: Response does not match OpenAPI schema
```

**æ’æŸ¥æ–¹æ³•ï¼š**
```python
# tests/test_contract_compliance.py
def test_create_user_contract(client):
    response = client.post("/api/users", json={...})

    # è¯¦ç»†é”™è¯¯ä¿¡æ¯
    from openapi_core.validation.response import openapi_response_validator
    validator = openapi_response_validator(openapi_spec)
    result = validator.validate(response)

    for error in result.errors:
        print(f"âŒ {error}")

    # è¾“å‡ºï¼š
    # âŒ Response body does not match schema:
    #    Missing required field: 'created_at'
```

**è§£å†³æ–¹æ¡ˆï¼š**
```python
# ä¿®å¤å®ç°ï¼Œæ·»åŠ ç¼ºå¤±å­—æ®µ
@app.post("/api/users")
def create_user(user_data: UserCreate):
    user = User(
        email=user_data.email,
        name=user_data.name,
        created_at=datetime.utcnow()  # â† æ·»åŠ ç¼ºå¤±å­—æ®µ
    )
    # ...
    return user
```

---

## ğŸ’¡ æœ€ä½³å®è·µæ€»ç»“

### âœ… DOï¼ˆæ¨èåšæ³•ï¼‰

1. **æ—©æœŸå®šä¹‰å®ªæ³•**
   ```
   âœ… é¡¹ç›®å¯åŠ¨æ—¶å°±åˆ›å»ºå®ªæ³•
   âœ… å›¢é˜Ÿå…±åŒè®¨è®ºï¼Œè¾¾æˆå…±è¯†
   âœ… ç‰ˆæœ¬åŒ–ç®¡ç†å®ªæ³•
   ```

2. **å¥‘çº¦ä¼˜å…ˆ**
   ```
   âœ… API å…ˆå®šä¹‰ OpenAPI å¥‘çº¦
   âœ… å‰åç«¯åŸºäºå¥‘çº¦å¹¶è¡Œå¼€å‘
   âœ… ä½¿ç”¨ Mock æœåŠ¡å™¨
   âœ… å¥‘çº¦æµ‹è¯•ä¿è¯ä¸€è‡´æ€§
   ```

3. **å¤šæ–¹æ¡ˆæ¢ç´¢**
   ```
   âœ… æŠ€æœ¯é€‰å‹ä¸ç¡®å®šæ—¶ï¼Œç”Ÿæˆå¤šä¸ª plan
   âœ… å¹¶è¡Œå®ç° POCï¼ŒåŸºå‡†æµ‹è¯•å¯¹æ¯”
   âœ… æ•°æ®é©±åŠ¨å†³ç­–
   ```

4. **è‡ªåŠ¨åŒ–éªŒè¯**
   ```
   âœ… CI/CD ç®¡é“éªŒè¯å®ªæ³•åˆè§„æ€§
   âœ… è‡ªåŠ¨è¿è¡Œå¥‘çº¦æµ‹è¯•
   âœ… æ€§èƒ½æµ‹è¯•é—¨æ§
   ```

### âŒ DON'Tï¼ˆé¿å…åšæ³•ï¼‰

1. **è·³è¿‡å®ªæ³•**
   ```
   âŒ ç›´æ¥å¼€å§‹å†™ä»£ç 
   âŒ æ¯ä¸ªäººå„è‡ªä¸ºæ”¿
   âŒ äº‹åæ‰å®šä¹‰æ ‡å‡†
   ```

2. **å…ˆå®ç°å†å®šä¹‰å¥‘çº¦**
   ```
   âŒ åç«¯å®ç°å®Œå†å®šä¹‰ API
   âŒ å‰ç«¯ç­‰å¾…åç«¯å®Œæˆ
   âŒ æ‰‹å·¥ç¼–å†™ API æ–‡æ¡£
   ```

3. **å•ä¸€æŠ€æœ¯æ ˆç›²ç›®æ¨è¿›**
   ```
   âŒ ä¸éªŒè¯å°±é€‰æ‹©æŠ€æœ¯æ ˆ
   âŒ æ²¡æœ‰å¯¹æ¯”åŸºå‡†æµ‹è¯•
   âŒ å‡­æ„Ÿè§‰åšå†³ç­–
   ```

---

## ğŸš€ ä¸‹ä¸€æ­¥

æ­å–œä½ æŒæ¡äº† Spec-kit çš„é«˜çº§æŠ€å·§ï¼ç°åœ¨ä½ å·²ç»å­¦ä¼šï¼š

âœ… å®ªæ³•æ¡†æ¶çš„æ·±åº¦åº”ç”¨
âœ… å¥‘çº¦ä¼˜å…ˆå¼€å‘å®Œæ•´æµç¨‹
âœ… å¤šæŠ€æœ¯æ ˆå¹¶è¡Œæ¢ç´¢
âœ… å›¢é˜Ÿåä½œæœ€ä½³å®è·µ
âœ… CI/CD é›†æˆæ–¹æ¡ˆ
âœ… è°ƒè¯•ä¸æ•…éšœæ’æŸ¥

**ä¸‹ä¸€æ­¥ï¼š** [4.5 æœ¬ç« å°ç»“](./4.5-æœ¬ç« å°ç»“.md) - å›é¡¾æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼ŒæŸ¥çœ‹å¸¸è§é—®é¢˜å’Œèµ„æºæ¨èï¼

---

*Spec-kit æ ¸å¿ƒæ¦‚å¿µæ•™ç¨‹ v1.0 | 2025 Edition | åŸºäº GitHub Spec-kit å®˜æ–¹ä»“åº“*
