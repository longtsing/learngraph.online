# 6.4 Assistants - è¯¦ç»†è§£è¯»

## ä¸€ã€æ¦‚è¿°

### 1.1 æœ¬èŠ‚ç®€ä»‹

åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•éƒ¨ç½²ã€è¿æ¥å’Œç®¡ç† LangGraph åº”ç”¨ã€‚ç°åœ¨åœ¨ 6.4 èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹  **Assistantsï¼ˆåŠ©æ‰‹ï¼‰**ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå…è®¸ä½ ä¸ºåŒä¸€ä¸ªå›¾åˆ›å»ºå¤šä¸ª"äººæ ¼"æˆ–è¡Œä¸ºå˜ä½“ã€‚

**æ ¸å¿ƒé—®é¢˜**ï¼š
- å¦‚ä½•ä¸ºä¸åŒåœºæ™¯å®šåˆ¶ç›¸åŒçš„åº”ç”¨ï¼Ÿ
- å¦‚ä½•ç®¡ç†åº”ç”¨çš„å¤šä¸ªç‰ˆæœ¬ï¼Ÿ
- å¦‚ä½•è®©ç”¨æˆ·é€‰æ‹©ä¸åŒçš„åŠ©æ‰‹ï¼Ÿ

### 1.2 ä»€ä¹ˆæ˜¯ Assistantï¼Ÿ

**Assistant** = å›¾ + é…ç½®

```
Assistant
â”œâ”€â”€ Graphï¼ˆå›¾çš„å®ç°ï¼‰
â”‚   â””â”€â”€ task_maistro
â”‚
â””â”€â”€ Configï¼ˆé…ç½®ï¼‰
    â”œâ”€â”€ user_id: "lance"
    â”œâ”€â”€ todo_category: "work"
    â””â”€â”€ task_maistro_role: "ä¸“ä¸šåŠ©æ‰‹..."
```

**ç±»æ¯”**ï¼š
- **Graphï¼ˆå›¾ï¼‰** = æ±½è½¦çš„åŸºæœ¬ç»“æ„å’Œå¼•æ“
- **Assistantï¼ˆåŠ©æ‰‹ï¼‰** = ä¸åŒçš„é©¾é©¶æ¨¡å¼ï¼ˆè¿åŠ¨æ¨¡å¼ã€èŠ‚èƒ½æ¨¡å¼ã€èˆ’é€‚æ¨¡å¼ï¼‰

### 1.3 ä¸ºä»€ä¹ˆéœ€è¦ Assistantsï¼Ÿ

**æ²¡æœ‰ Assistants çš„ç—›ç‚¹**ï¼š
```python
# æ¯æ¬¡éƒ½è¦ä¼ é€’é…ç½®
config = {
    "configurable": {
        "user_id": "lance",
        "todo_category": "work",
        "task_maistro_role": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å·¥ä½œåŠ©æ‰‹..."
    }
}

run = await client.runs.create(thread_id, "task_maistro", input, config=config)
```

**æœ‰äº† Assistants**ï¼š
```python
# åˆ›å»ºä¸€æ¬¡ï¼Œå¤šæ¬¡ä½¿ç”¨
work_assistant = await client.assistants.create(
    "task_maistro",
    config={"configurable": {...}}
)

# ä»¥åç›´æ¥ä½¿ç”¨ assistant_id
run = await client.runs.create(thread_id, work_assistant_id, input)
```

### 1.4 Assistants çš„åº”ç”¨åœºæ™¯

**å®é™…åœºæ™¯ç¤ºä¾‹**ï¼š

```
åŒä¸€ä¸ªä»»åŠ¡ç®¡ç†å›¾
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Personal Assistant                      â”‚
â”‚  - todo_category: "personal"             â”‚
â”‚  - é£æ ¼ï¼šå‹å¥½ã€é¼“åŠ±                      â”‚
â”‚  - ç”¨é€”ï¼šä¸ªäººç”Ÿæ´»ä»»åŠ¡                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Work Assistant                          â”‚
â”‚  - todo_category: "work"                 â”‚
â”‚  - é£æ ¼ï¼šä¸“ä¸šã€é«˜æ•ˆ                      â”‚
â”‚  - ç”¨é€”ï¼šå·¥ä½œä»»åŠ¡                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Family Assistant                        â”‚
â”‚  - todo_category: "family"               â”‚
â”‚  - é£æ ¼ï¼šæ¸©é¦¨ã€åè°ƒ                      â”‚
â”‚  - ç”¨é€”ï¼šå®¶åº­äº‹åŠ¡                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.5 å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬èŠ‚å­¦ä¹ ï¼Œä½ å°†æŒæ¡ï¼š

1. **ç†è§£ Assistants æ¦‚å¿µ**
   - ä»€ä¹ˆæ˜¯ assistant
   - å¦‚ä½•é…ç½® assistant
   - Assistant vs ç›´æ¥ä½¿ç”¨å›¾

2. **åˆ›å»ºå’Œç®¡ç† Assistants**
   - åˆ›å»º assistant
   - æ›´æ–° assistantï¼ˆç‰ˆæœ¬æ§åˆ¶ï¼‰
   - åˆ é™¤ assistant
   - æœç´¢ assistants

3. **ä½¿ç”¨ Assistants**
   - ä½¿ç”¨ä¸åŒçš„ assistants
   - è§‚å¯Ÿä¸åŒè¡Œä¸º
   - å®é™…åº”ç”¨åœºæ™¯

---

## äºŒã€å‡†å¤‡å·¥ä½œ

### 2.1 é…ç½®åŒ–çš„å›¾

è¦ä½¿ç”¨ assistantsï¼Œä½ çš„å›¾å¿…é¡»æ”¯æŒé…ç½®åŒ–ã€‚`task_maistro` å·²ç»åšå¥½äº†å‡†å¤‡ã€‚

**é…ç½®æ–‡ä»¶**ï¼š`deployment/configuration.py`
```python
from langgraph.graph import StateGraph
from langgraph.config import Configuration

# å®šä¹‰å¯é…ç½®çš„å­—æ®µ
class Configurable(Configuration):
    user_id: str = Field(default="default_user")
    todo_category: str = Field(default="general")
    task_maistro_role: str = Field(
        default="You are a helpful task assistant..."
    )

# åœ¨å›¾çš„èŠ‚ç‚¹ä¸­ä½¿ç”¨é…ç½®
def some_node(state, config):
    user_id = config["configurable"]["user_id"]
    todo_category = config["configurable"]["todo_category"]
    role = config["configurable"]["task_maistro_role"]

    # ä½¿ç”¨è¿™äº›é…ç½®...
```

**å¯é…ç½®å­—æ®µ**ï¼š
- `user_id`ï¼šç”¨æˆ·æ ‡è¯†
- `todo_category`ï¼šå¾…åŠç±»åˆ«ï¼ˆpersonal, work, family, etc.ï¼‰
- `task_maistro_role`ï¼šåŠ©æ‰‹çš„ç³»ç»Ÿæç¤ºè¯ï¼ˆå®šä¹‰è¡Œä¸ºé£æ ¼ï¼‰

### 2.2 è¿æ¥åˆ°éƒ¨ç½²

```python
%%capture --no-stderr
%pip install -U langgraph_sdk
```

```python
from langgraph_sdk import get_client

url_for_cli_deployment = "http://localhost:8123"
client = get_client(url=url_for_cli_deployment)
```

---

## ä¸‰ã€åˆ›å»º Assistants

### 3.1 åˆ›å»º Personal Assistant

**ç›®æ ‡**ï¼šåˆ›å»ºä¸€ä¸ªç®¡ç†ä¸ªäººä»»åŠ¡çš„åŠ©æ‰‹ã€‚

```python
# åˆ›å»º personal assistant
personal_assistant = await client.assistants.create(
    "task_maistro",  # å›¾çš„åç§°
    config={"configurable": {"todo_category": "personal"}}
)

print(personal_assistant)
```

**è¾“å‡º**ï¼š
```python
{
    'assistant_id': 'e6ab9c39-4b56-4db9-bb39-a71484c5d408',
    'graph_id': 'task_maistro',
    'created_at': '2025-07-31T18:33:39.897312+00:00',
    'updated_at': '2025-07-31T18:33:39.897312+00:00',
    'config': {
        'configurable': {
            'todo_category': 'personal'
        }
    },
    'metadata': {},
    'version': 1,
    'name': 'Untitled',
    'description': None,
    'context': {}
}
```

**å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|------|------|--------|
| `assistant_id` | åŠ©æ‰‹å”¯ä¸€æ ‡è¯† | UUID |
| `graph_id` | å…³è”çš„å›¾ | `task_maistro` |
| `created_at` | åˆ›å»ºæ—¶é—´ | ISO 8601 æ ¼å¼ |
| `updated_at` | æ›´æ–°æ—¶é—´ | ISO 8601 æ ¼å¼ |
| `config` | é…ç½® | å¯é…ç½®å­—æ®µ |
| `metadata` | å…ƒæ•°æ® | è‡ªå®šä¹‰æ•°æ® |
| `version` | ç‰ˆæœ¬å· | 1, 2, 3, ... |
| `name` | åç§° | å¯é€‰ |
| `description` | æè¿° | å¯é€‰ |

### 3.2 æ›´æ–° Assistantï¼ˆç‰ˆæœ¬æ§åˆ¶ï¼‰

ç°åœ¨è®©æˆ‘ä»¬æ›´æ–° personal assistantï¼Œæ·»åŠ æ›´å¤šé…ç½®ï¼š

```python
# å®šä¹‰åŠ©æ‰‹çš„è§’è‰²å’Œé£æ ¼
task_maistro_role = """You are a friendly and organized personal task assistant.
Your main focus is helping users stay on top of their personal tasks and commitments.

Specifically:
- Help track and organize personal tasks
- When providing a 'todo summary':
  1. List all current tasks grouped by deadline (overdue, today, this week, future)
  2. Highlight any tasks missing deadlines and gently encourage adding them
  3. Note any tasks that seem important but lack time estimates
- Proactively ask for deadlines when new tasks are added without them
- Maintain a supportive tone while helping the user stay accountable
- Help prioritize tasks based on deadlines and importance

Your communication style should be encouraging and helpful, never judgmental.

When tasks are missing deadlines, respond with something like "I notice [task] doesn't
have a deadline yet. Would you like to add one to help us track it better?"
"""

# å®Œæ•´çš„é…ç½®
configurations = {
    "todo_category": "personal",
    "user_id": "lance",
    "task_maistro_role": task_maistro_role
}

# æ›´æ–° assistant
personal_assistant = await client.assistants.update(
    personal_assistant["assistant_id"],
    config={"configurable": configurations}
)

print(personal_assistant)
```

**è¾“å‡º**ï¼š
```python
{
    'assistant_id': 'e6ab9c39-4b56-4db9-bb39-a71484c5d408',  # ID ä¸å˜
    'graph_id': 'task_maistro',
    'created_at': '2025-07-31T18:33:39.908742+00:00',
    'updated_at': '2025-07-31T18:33:39.908742+00:00',  # æ›´æ–°æ—¶é—´å˜äº†
    'config': {
        'configurable': {
            'user_id': 'lance',
            'todo_category': 'personal',
            'task_maistro_role': '...'  # å®Œæ•´çš„è§’è‰²å®šä¹‰
        }
    },
    'metadata': {},
    'version': 2,  # ç‰ˆæœ¬å·ä» 1 å˜ä¸º 2
    'name': 'Untitled',
    'description': None,
    'context': {}
}
```

**å…³é”®ç‚¹**ï¼š
- `assistant_id` ä¿æŒä¸å˜
- `version` ä» 1 å¢åŠ åˆ° 2
- `updated_at` æ›´æ–°
- é…ç½®è¢«å®Œå…¨æ›¿æ¢

**ç‰ˆæœ¬æ§åˆ¶çš„ä½œç”¨**ï¼š
- è¿½è¸ª assistant çš„å˜åŒ–
- å¯ä»¥å›æ»šåˆ°æ—§ç‰ˆæœ¬
- æ–¹ä¾¿ A/B æµ‹è¯•

### 3.3 åˆ›å»º Work Assistant

ç°åœ¨åˆ›å»ºä¸€ä¸ªå®Œå…¨ä¸åŒçš„ work assistantï¼š

```python
# Work assistant çš„è§’è‰²å®šä¹‰
task_maistro_role = """You are a focused and efficient work task assistant.

Your main focus is helping users manage their work commitments with realistic timeframes.

Specifically:
- Help track and organize work tasks
- When providing a 'todo summary':
  1. List all current tasks grouped by deadline (overdue, today, this week, future)
  2. Highlight any tasks missing deadlines and gently encourage adding them
  3. Note any tasks that seem important but lack time estimates
- When discussing new tasks, suggest that the user provide realistic time-frames based on task type:
  â€¢ Developer Relations features: typically 1 day
  â€¢ Course lesson reviews/feedback: typically 2 days
  â€¢ Documentation sprints: typically 3 days
- Help prioritize tasks based on deadlines and team dependencies
- Maintain a professional tone while helping the user stay accountable

Your communication style should be supportive but practical.

When tasks are missing deadlines, respond with something like "I notice [task] doesn't
have a deadline yet. Based on similar tasks, this might take [suggested timeframe].
Would you like to set a deadline with this in mind?"
"""

# Work assistant é…ç½®
configurations = {
    "todo_category": "work",
    "user_id": "lance",
    "task_maistro_role": task_maistro_role
}

# åˆ›å»º work assistant
work_assistant = await client.assistants.create(
    "task_maistro",
    config={"configurable": configurations}
)

print(work_assistant)
```

**è¾“å‡º**ï¼š
```python
{
    'assistant_id': '4b9de9bd-95ff-477f-8cd0-dee4575f4eed',  # æ–°çš„ ID
    'graph_id': 'task_maistro',
    'created_at': '2025-07-31T18:33:39.914775+00:00',
    'updated_at': '2025-07-31T18:33:39.914775+00:00',
    'config': {
        'configurable': {
            'user_id': 'lance',
            'todo_category': 'work',  # ä¸åŒçš„ç±»åˆ«
            'task_maistro_role': '...'  # ä¸åŒçš„è§’è‰²
        }
    },
    'metadata': {},
    'version': 1,  # æ–° assistantï¼Œç‰ˆæœ¬ä» 1 å¼€å§‹
    'name': 'Untitled',
    'description': None,
    'context': {}
}
```

**Personal vs Work Assistant å¯¹æ¯”**ï¼š

| ç‰¹æ€§ | Personal Assistant | Work Assistant |
|------|-------------------|----------------|
| **todo_category** | `personal` | `work` |
| **é£æ ¼** | å‹å¥½ã€é¼“åŠ±æ€§ | ä¸“ä¸šã€é«˜æ•ˆ |
| **é‡ç‚¹** | ä¸ªäººæ‰¿è¯ºã€çµæ´»æ€§ | å·¥ä½œä»»åŠ¡ã€æ—¶é—´ç®¡ç† |
| **å»ºè®®** | é¼“åŠ±æ·»åŠ æˆªæ­¢æ—¥æœŸ | åŸºäºä»»åŠ¡ç±»å‹å»ºè®®æ—¶é—´ |
| **è¯­æ°”** | æ°¸ä¸è¯„åˆ¤ | æ”¯æŒä½†å®é™… |

---

## å››ã€ç®¡ç† Assistants

### 4.1 æœç´¢ Assistants

æ‰€æœ‰ assistants éƒ½å­˜å‚¨åœ¨ PostgreSQL ä¸­ï¼Œå¯ä»¥è½»æ¾æœç´¢ï¼š

```python
# æœç´¢æ‰€æœ‰ assistants
assistants = await client.assistants.search()

for assistant in assistants:
    print({
        'assistant_id': assistant['assistant_id'],
        'version': assistant['version'],
        'config': assistant['config']
    })
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```python
{
    'assistant_id': '4b9de9bd-95ff-477f-8cd0-dee4575f4eed',
    'version': 1,
    'config': {
        'configurable': {
            'user_id': 'lance',
            'todo_category': 'work',
            'task_maistro_role': '...'
        }
    }
}
{
    'assistant_id': 'e6ab9c39-4b56-4db9-bb39-a71484c5d408',
    'version': 2,
    'config': {
        'configurable': {
            'user_id': 'lance',
            'todo_category': 'personal',
            'task_maistro_role': '...'
        }
    }
}
```

**æœç´¢å‚æ•°**ï¼š
```python
# æœç´¢ç‰¹å®šå›¾çš„ assistants
assistants = await client.assistants.search(
    graph_id="task_maistro"
)

# é™åˆ¶è¿”å›æ•°é‡
assistants = await client.assistants.search(
    limit=10,
    offset=0
)
```

### 4.2 åˆ é™¤ Assistants

å¯ä»¥åˆ é™¤ä¸å†ä½¿ç”¨çš„ assistantsï¼š

```python
# åˆ›å»ºä¸´æ—¶ assistant
temp_assistant = await client.assistants.create(
    "task_maistro",
    config={"configurable": configurations}
)

# æŸ¥çœ‹æ‰€æœ‰ assistants
assistants = await client.assistants.search()
for assistant in assistants:
    print(f"before delete: {{'assistant_id': {assistant['assistant_id']}}}")

# åˆ é™¤ä¸´æ—¶ assistant
await client.assistants.delete(assistants[-1]["assistant_id"])

# å†æ¬¡æŸ¥çœ‹
assistants = await client.assistants.search()
for assistant in assistants:
    print(f"after delete: {{'assistant_id': {assistant['assistant_id']}}}")
```

**è¾“å‡º**ï¼š
```
before delete: {'assistant_id': f79e12f9-67f2-46c2-9b5b-e7fa6ad31355}
before delete: {'assistant_id': 4b9de9bd-95ff-477f-8cd0-dee4575f4eed}
before delete: {'assistant_id': e6ab9c39-4b56-4db9-bb39-a71484c5d408}
before delete: {'assistant_id': 4a2980c5-2812-4d8e-ae62-3fb72f9ef98f}
before delete: {'assistant_id': 4955437e-b617-4a25-8470-11f49f71f388}

after delete: {'assistant_id': f79e12f9-67f2-46c2-9b5b-e7fa6ad31355}
after delete: {'assistant_id': 4b9de9bd-95ff-477f-8cd0-dee4575f4eed}
after delete: {'assistant_id': e6ab9c39-4b56-4db9-bb39-a71484c5d408}
after delete: {'assistant_id': 4a2980c5-2812-4d8e-ae62-3fb72f9ef98f}
```

### 4.3 è·å–ç‰¹å®š Assistant

```python
# é€šè¿‡ ID è·å– assistant
assistant = await client.assistants.get(assistant_id)

# è·å–ç‰¹å®šç‰ˆæœ¬
assistant = await client.assistants.get(assistant_id, version=1)
```

---

## äº”ã€ä½¿ç”¨ Assistants

### 5.1 è®¾ç½® Assistant IDs

```python
# è·å– assistants åˆ—è¡¨
assistants = await client.assistants.search()

# è®¾ç½®è¦ä½¿ç”¨çš„ assistant IDs
work_assistant_id = assistants[0]['assistant_id']
personal_assistant_id = assistants[1]['assistant_id']
```

### 5.2 ä½¿ç”¨ Work Assistant

```python
from langchain_core.messages import HumanMessage
from langchain_core.messages import convert_to_messages

# ç”¨æˆ·è¾“å…¥
user_input = "Create or update few ToDos: 1) Re-film Module 6, lesson 5 by end of day today. 2) Update audioUX by next Monday."

# åˆ›å»ºçº¿ç¨‹
thread = await client.threads.create()

# ä½¿ç”¨ work assistant è¿è¡Œ
async for chunk in client.runs.stream(
    thread["thread_id"],
    work_assistant_id,  # ä½¿ç”¨ work assistant
    input={"messages": [HumanMessage(content=user_input)]},
    stream_mode="values"
):
    if chunk.event == 'values':
        state = chunk.data
        convert_to_messages(state["messages"])[-1].pretty_print()
```

**è¾“å‡º**ï¼š
```
================================ Human Message =================================
Create or update few ToDos: 1) Re-film Module 6, lesson 5 by end of day today.
2) Update audioUX by next Monday.

================================== Ai Message ==================================
I've updated your ToDo list with the tasks and deadlines you provided. Here's a
summary of your current tasks:

### Overdue
- None

### Today
- **Re-film Module 6, lesson 5**: Deadline is today by the end of the day.

### This Week
- **Update audioUX**: Deadline is next Monday, August 4th.

### Future
- **Finalize set of report generation tutorials**: Deadline is August 5th.

I noticed that the task "Update audioUX" doesn't have a time estimate yet. Based
on similar tasks, this might take about 1 day. Would you like to set a time estimate
with this in mind?
```

**è§‚å¯Ÿ Work Assistant çš„è¡Œä¸º**ï¼š
- âœ… æŒ‰æˆªæ­¢æ—¥æœŸåˆ†ç»„ï¼ˆOverdue, Today, This Week, Futureï¼‰
- âœ… æé†’ç¼ºå°‘æ—¶é—´ä¼°è®¡
- âœ… **å»ºè®®åŸºäºç›¸ä¼¼ä»»åŠ¡çš„æ—¶é—´**ï¼ˆ"might take about 1 day"ï¼‰
- âœ… ä¸“ä¸šã€é«˜æ•ˆçš„è¯­æ°”

### 5.3 Work Assistant çš„"æ¨å›"è¡Œä¸º

```python
# å°è¯•åˆ›å»ºå·²å­˜åœ¨çš„ä»»åŠ¡
user_input = "Create another ToDo: Finalize set of report generation tutorials."
thread = await client.threads.create()

async for chunk in client.runs.stream(
    thread["thread_id"],
    work_assistant_id,
    input={"messages": [HumanMessage(content=user_input)]},
    stream_mode="values"
):
    if chunk.event == 'values':
        state = chunk.data
        convert_to_messages(state["messages"])[-1].pretty_print()
```

**è¾“å‡º**ï¼š
```
================================ Human Message =================================
Create another ToDo: Finalize set of report generation tutorials.

================================== Ai Message ==================================
It looks like the task "Finalize set of report generation tutorials" is already
on your ToDo list with a deadline of August 5, 2025. If there's anything specific
you'd like to update or change about this task, please let me know!
```

**è¡Œä¸ºåˆ†æ**ï¼š
- Work assistant æ£€æµ‹åˆ°ä»»åŠ¡å·²å­˜åœ¨
- ä¸»åŠ¨æé†’ç”¨æˆ·ï¼Œè€Œä¸æ˜¯åˆ›å»ºé‡å¤ä»»åŠ¡
- è¯¢é—®æ˜¯å¦éœ€è¦æ›´æ–°
- è¿™æ˜¯å› ä¸º `task_maistro_role` ä¸­å®šä¹‰çš„ä¸“ä¸šè¡Œä¸º

### 5.4 æ·»åŠ æˆªæ­¢æ—¥æœŸ

```python
user_input = "OK, for this task let's get it done by next Tuesday."

async for chunk in client.runs.stream(
    thread["thread_id"],
    work_assistant_id,
    input={"messages": [HumanMessage(content=user_input)]},
    stream_mode="values"
):
    if chunk.event == 'values':
        state = chunk.data
        convert_to_messages(state["messages"])[-1].pretty_print()
```

**è¾“å‡º**ï¼š
```
================================ Human Message =================================
OK, for this task let's get it done by next Tuesday.

================================== Ai Message ==================================
I've updated the deadline for "Finalize set of report generation tutorials" to
next Tuesday, which is August 5, 2025. If there's anything else you'd like to
adjust, feel free to let me know!
```

### 5.5 ä½¿ç”¨ Personal Assistant

ç°åœ¨ä½¿ç”¨ personal assistantï¼Œè§‚å¯Ÿä¸åŒçš„è¡Œä¸ºï¼š

```python
user_input = "Create ToDos: 1) Check on swim lessons for the baby this weekend. 2) For winter travel, check AmEx points."

thread = await client.threads.create()

async for chunk in client.runs.stream(
    thread["thread_id"],
    personal_assistant_id,  # ä½¿ç”¨ personal assistant
    input={"messages": [HumanMessage(content=user_input)]},
    stream_mode="values"
):
    if chunk.event == 'values':
        state = chunk.data
        convert_to_messages(state["messages"])[-1].pretty_print()
```

**è¾“å‡º**ï¼š
```
================================ Human Message =================================
Create ToDos: 1) Check on swim lessons for the baby this weekend. 2) For winter
travel, check AmEx points.

================================== Ai Message ==================================
I've added the tasks to your ToDo list:

1. Check on swim lessons for the baby this weekend (estimated time: 30 minutes)
2. For winter travel, check AmEx points (estimated time: 45 minutes)

I notice these tasks don't have deadlines yet. Would you like to set a deadline for them?
```

**è§‚å¯Ÿ Personal Assistant çš„è¡Œä¸º**ï¼š
- âœ… å‹å¥½ã€é¼“åŠ±çš„è¯­æ°”
- âœ… è‡ªåŠ¨ä¼°è®¡æ—¶é—´
- âœ… æ¸©å’Œåœ°è¯¢é—®æ˜¯å¦æ·»åŠ æˆªæ­¢æ—¥æœŸï¼ˆ"Would you like to..."ï¼‰
- âœ… ä¸ä¼šåƒ work assistant é‚£æ ·å»ºè®®å…·ä½“æ—¶é—´

### 5.6 Personal Assistant çš„ ToDo æ€»ç»“

```python
user_input = "Give me a todo summary."

thread = await client.threads.create()

async for chunk in client.runs.stream(
    thread["thread_id"],
    personal_assistant_id,
    input={"messages": [HumanMessage(content=user_input)]},
    stream_mode="values"
):
    if chunk.event == 'values':
        state = chunk.data
        convert_to_messages(state["messages"])[-1].pretty_print()
```

**è¾“å‡º**ï¼š
```
================================ Human Message =================================
Give me a todo summary.

================================== Ai Message ==================================
Here's your current ToDo summary:

**Overdue:**
- Re-film Module 6, lesson 5 (Deadline: 2025-07-30)

**Due This Week:**
- Update audioUX (Deadline: 2025-08-04)
- Finalize set of report generation tutorials (Deadline: 2025-08-05)

**No Deadline:**
- For winter travel, check AmEx points
- Check on swim lessons for the baby this weekend

**Notes:**
- The task "Update audioUX" doesn't have a time estimate. It might be important
  to add one to better manage your time.
- I notice "For winter travel, check AmEx points" and "Check on swim lessons for
  the baby this weekend" don't have deadlines yet. Would you like to set deadlines
  for these tasks?
```

**å…³é”®è§‚å¯Ÿ**ï¼š
- Personal assistant è®¿é—®äº† **æ‰€æœ‰ç±»åˆ«** çš„å¾…åŠï¼ˆåŒ…æ‹¬ work ç±»åˆ«çš„ï¼‰
- è¿™æ˜¯å› ä¸ºå®ƒä½¿ç”¨çš„æ˜¯ **ç›¸åŒçš„ user_idï¼ˆ"lance"ï¼‰**
- Store ä¸­çš„æ•°æ®æŒ‰ `(todo_category, user_id)` ç»„ç»‡
- Personal assistant çš„ todo_category æ˜¯ "personal"ï¼Œä½†å®ƒèƒ½çœ‹åˆ°å…¶ä»–ç±»åˆ«

**å®é™…åº”ç”¨ä¸­çš„è§£å†³æ–¹æ¡ˆ**ï¼š
- æ–¹æ¡ˆ 1ï¼šåœ¨ Store æŸ¥è¯¢æ—¶åªè¿”å›ç‰¹å®š category çš„å¾…åŠ
- æ–¹æ¡ˆ 2ï¼šåœ¨ç³»ç»Ÿæç¤ºä¸­å‘Šè¯‰ assistant åªå…³æ³¨ç‰¹å®šç±»åˆ«
- æ–¹æ¡ˆ 3ï¼šä½¿ç”¨ä¸åŒçš„ user_id æ¥å®Œå…¨éš”ç¦»

---

## å…­ã€Assistants çš„é«˜çº§åº”ç”¨

### 6.1 å›¢é˜Ÿåä½œåœºæ™¯

```python
# åˆ›å»ºå›¢é˜Ÿçš„ä¸åŒåŠ©æ‰‹
team_manager = await client.assistants.create(
    "task_maistro",
    config={
        "configurable": {
            "user_id": "team",
            "todo_category": "team",
            "task_maistro_role": "ä½ æ˜¯å›¢é˜Ÿç»ç†åŠ©æ‰‹ï¼Œå¸®åŠ©åè°ƒå›¢é˜Ÿä»»åŠ¡..."
        }
    }
)

developer_assistant = await client.assistants.create(
    "task_maistro",
    config={
        "configurable": {
            "user_id": "developer",
            "todo_category": "development",
            "task_maistro_role": "ä½ æ˜¯å¼€å‘åŠ©æ‰‹ï¼Œå…³æ³¨æŠ€æœ¯ä»»åŠ¡..."
        }
    }
)
```

### 6.2 å¤šè¯­è¨€æ”¯æŒ

```python
# ä¸­æ–‡åŠ©æ‰‹
chinese_assistant = await client.assistants.create(
    "task_maistro",
    config={
        "configurable": {
            "user_id": "user_cn",
            "todo_category": "general",
            "task_maistro_role": "ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„ä¸­æ–‡ä»»åŠ¡åŠ©æ‰‹..."
        }
    }
)

# è‹±æ–‡åŠ©æ‰‹
english_assistant = await client.assistants.create(
    "task_maistro",
    config={
        "configurable": {
            "user_id": "user_en",
            "todo_category": "general",
            "task_maistro_role": "You are a friendly English task assistant..."
        }
    }
)
```

### 6.3 å®éªŒå’Œ A/B æµ‹è¯•

```python
# ç‰ˆæœ¬ Aï¼šç®€çŸ­å“åº”
assistant_v1 = await client.assistants.create(
    "task_maistro",
    config={
        "configurable": {
            "task_maistro_role": "ä¿æŒå›å¤ç®€çŸ­ï¼Œä¸è¶…è¿‡ 3 å¥è¯..."
        }
    }
)

# ç‰ˆæœ¬ Bï¼šè¯¦ç»†å“åº”
assistant_v2 = await client.assistants.create(
    "task_maistro",
    config={
        "configurable": {
            "task_maistro_role": "æä¾›è¯¦ç»†çš„è§£é‡Šå’Œå»ºè®®..."
        }
    }
)

# åˆ†é…ç»™ä¸åŒç”¨æˆ·æµ‹è¯•
if user_group == "A":
    assistant_id = assistant_v1["assistant_id"]
else:
    assistant_id = assistant_v2["assistant_id"]
```

### 6.4 åŠ¨æ€åŠ©æ‰‹é€‰æ‹©

```python
async def select_assistant(user_request, client):
    """æ ¹æ®ç”¨æˆ·è¯·æ±‚åŠ¨æ€é€‰æ‹©åŠ©æ‰‹"""

    # åˆ†æç”¨æˆ·è¯·æ±‚
    if "work" in user_request.lower() or "project" in user_request.lower():
        # å·¥ä½œç›¸å…³ï¼Œä½¿ç”¨ work assistant
        assistants = await client.assistants.search()
        work_assistants = [
            a for a in assistants
            if a['config']['configurable'].get('todo_category') == 'work'
        ]
        return work_assistants[0]['assistant_id']

    elif "family" in user_request.lower() or "home" in user_request.lower():
        # å®¶åº­ç›¸å…³ï¼Œä½¿ç”¨ personal assistant
        assistants = await client.assistants.search()
        personal_assistants = [
            a for a in assistants
            if a['config']['configurable'].get('todo_category') == 'personal'
        ]
        return personal_assistants[0]['assistant_id']

    else:
        # é»˜è®¤ä½¿ç”¨é€šç”¨ assistant
        return "default_assistant_id"

# ä½¿ç”¨
user_request = "Add a work task to review the quarterly report"
assistant_id = await select_assistant(user_request, client)

run = await client.runs.create(
    thread_id,
    assistant_id,
    input={"messages": [HumanMessage(content=user_request)]}
)
```

---

## ä¸ƒã€æœ€ä½³å®è·µ

### 7.1 å‘½åå’Œæè¿°

```python
# å¥½çš„å®è·µï¼šæ¸…æ™°çš„å‘½åå’Œæè¿°
personal_assistant = await client.assistants.create(
    "task_maistro",
    config={"configurable": {...}},
    metadata={
        "name": "Lance's Personal Assistant",
        "description": "Manages personal tasks with a friendly, encouraging tone",
        "category": "personal",
        "owner": "lance"
    }
)
```

### 7.2 ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

```python
# åˆ›å»ºæ–° assistant è€Œä¸æ˜¯æ›´æ–°ç°æœ‰çš„
# è¿™æ ·å¯ä»¥ä¿ç•™æ‰€æœ‰å†å²ç‰ˆæœ¬

# ä¸å¥½çš„åšæ³•ï¼š
await client.assistants.update(assistant_id, config=new_config)

# å¥½çš„åšæ³•ï¼š
new_assistant = await client.assistants.create("task_maistro", config=new_config)
# æ—§ assistant ä»ç„¶å¯ç”¨ï¼Œå¦‚æœéœ€è¦å¯ä»¥å›æ»š
```

### 7.3 é…ç½®ç®¡ç†

```python
# é›†ä¸­ç®¡ç†é…ç½®
ASSISTANT_CONFIGS = {
    "personal": {
        "todo_category": "personal",
        "user_id": "lance",
        "task_maistro_role": "..."
    },
    "work": {
        "todo_category": "work",
        "user_id": "lance",
        "task_maistro_role": "..."
    },
    "family": {
        "todo_category": "family",
        "user_id": "family",
        "task_maistro_role": "..."
    }
}

# æ‰¹é‡åˆ›å»º
async def create_all_assistants(client):
    assistants = {}
    for name, config in ASSISTANT_CONFIGS.items():
        assistant = await client.assistants.create(
            "task_maistro",
            config={"configurable": config}
        )
        assistants[name] = assistant["assistant_id"]
    return assistants
```

### 7.4 é”™è¯¯å¤„ç†

```python
async def safe_create_assistant(client, graph_id, config):
    """å®‰å…¨åˆ›å»º assistant"""
    try:
        return await client.assistants.create(graph_id, config=config)
    except Exception as e:
        logger.error(f"Failed to create assistant: {e}")
        # è¿”å›é»˜è®¤ assistant æˆ–é‡è¯•
        return None

async def safe_use_assistant(client, thread_id, assistant_id, input):
    """å®‰å…¨ä½¿ç”¨ assistant"""
    try:
        return await client.runs.create(thread_id, assistant_id, input=input)
    except Exception as e:
        logger.error(f"Failed to use assistant {assistant_id}: {e}")
        # å›é€€åˆ°é»˜è®¤å›¾
        return await client.runs.create(thread_id, "task_maistro", input=input)
```

---

## å…«ã€å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 8.1 é—®é¢˜ï¼šAssistant é…ç½®æœªç”Ÿæ•ˆ

**ç°è±¡**ï¼šåˆ›å»ºäº† assistantï¼Œä½†è¡Œä¸ºæ²¡æœ‰å˜åŒ–

**æ£€æŸ¥æ¸…å•**ï¼š
1. å›¾æ˜¯å¦æ­£ç¡®è¯»å–é…ç½®ï¼Ÿ
2. é…ç½®å­—æ®µåæ˜¯å¦æ­£ç¡®ï¼Ÿ
3. æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„ assistant_idï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# éªŒè¯é…ç½®
assistant = await client.assistants.get(assistant_id)
print("Config:", assistant['config'])

# éªŒè¯è¿è¡Œæ—¶é…ç½®
run = await client.runs.create(thread_id, assistant_id, input=input)
run_details = await client.runs.get(thread_id, run["run_id"])
print("Run config:", run_details['kwargs']['config'])
```

### 8.2 é—®é¢˜ï¼šAssistant ä¹‹é—´æ•°æ®æ··æ·†

**ç°è±¡**ï¼šPersonal assistant çœ‹åˆ° work ä»»åŠ¡

**åŸå› **ï¼šä½¿ç”¨ç›¸åŒçš„ user_id

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ä¸åŒçš„ user_id
personal_config = {"user_id": "lance_personal", ...}
work_config = {"user_id": "lance_work", ...}

# æ–¹æ¡ˆ 2ï¼šåœ¨æŸ¥è¯¢æ—¶è¿‡æ»¤
def get_todos(store, user_id, category):
    namespace = ("todo", category, user_id)
    return store.search(namespace)
```

### 8.3 é—®é¢˜ï¼šç‰ˆæœ¬ç®¡ç†æ··ä¹±

**ç°è±¡**ï¼šä¸çŸ¥é“ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# ä½¿ç”¨å…ƒæ•°æ®æ ‡è®°ç‰ˆæœ¬
await client.assistants.update(
    assistant_id,
    config=config,
    metadata={
        "version_name": "v2.1-improved-suggestions",
        "changelog": "Added time estimation suggestions",
        "date": "2024-11-05"
    }
)

# æŸ¥è¯¢æ—¶æŸ¥çœ‹å…ƒæ•°æ®
assistants = await client.assistants.search()
for a in assistants:
    print(f"{a['assistant_id']}: {a['metadata'].get('version_name', 'unnamed')}")
```

---

## ä¹ã€æ€»ç»“

### 9.1 æ ¸å¿ƒè¦ç‚¹

1. **Assistant = Graph + Config**
   - å›¾çš„å®ç° + é…ç½®å‚æ•°
   - ä¸€ä¸ªå›¾å¯ä»¥æœ‰å¤šä¸ª assistants
   - æ¯ä¸ª assistant æœ‰ä¸åŒçš„è¡Œä¸º

2. **ç‰ˆæœ¬æ§åˆ¶**
   - æ›´æ–° assistant ä¼šå¢åŠ ç‰ˆæœ¬å·
   - å¯ä»¥è¿½è¸ªå˜åŒ–
   - æ”¯æŒå›æ»š

3. **æŒä¹…åŒ–**
   - Assistants å­˜å‚¨åœ¨ PostgreSQL
   - å¯ä»¥æœç´¢ã€æ›´æ–°ã€åˆ é™¤
   - è·¨ä¼šè¯æŒä¹…åŒ–

4. **å®é™…åº”ç”¨**
   - å¤šç”¨æˆ·åœºæ™¯
   - A/B æµ‹è¯•
   - å¤šè¯­è¨€æ”¯æŒ
   - ä¸ªæ€§åŒ–ä½“éªŒ

### 9.2 API å¿«é€Ÿå‚è€ƒ

```python
# åˆ›å»º
assistant = await client.assistants.create(graph_id, config=config)

# æ›´æ–°ï¼ˆåˆ›å»ºæ–°ç‰ˆæœ¬ï¼‰
assistant = await client.assistants.update(assistant_id, config=new_config)

# è·å–
assistant = await client.assistants.get(assistant_id)
assistant = await client.assistants.get(assistant_id, version=2)

# æœç´¢
assistants = await client.assistants.search()
assistants = await client.assistants.search(graph_id="task_maistro")

# åˆ é™¤
await client.assistants.delete(assistant_id)

# ä½¿ç”¨
run = await client.runs.create(thread_id, assistant_id, input=input)
```

### 9.3 æœ€ä½³å®è·µæ¸…å•

- âœ… ä½¿ç”¨æ¸…æ™°çš„é…ç½®å’Œæè¿°
- âœ… åˆ©ç”¨ç‰ˆæœ¬æ§åˆ¶è¿½è¸ªå˜åŒ–
- âœ… é›†ä¸­ç®¡ç† assistant é…ç½®
- âœ… ä¸ºä¸åŒåœºæ™¯åˆ›å»ºä¸“é—¨çš„ assistants
- âœ… å®ç°é”™è¯¯å¤„ç†å’Œå›é€€æœºåˆ¶
- âœ… ä½¿ç”¨å…ƒæ•°æ®è®°å½•ç‰ˆæœ¬ä¿¡æ¯
- âœ… å®šæœŸæ¸…ç†ä¸ç”¨çš„ assistants

### 9.4 Module-6 æ€»ç»“

æ­å–œä½ å®Œæˆäº† Module-6 çš„æ‰€æœ‰å†…å®¹ï¼è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ï¼š

| è¯¾ç¨‹ | ä¸»é¢˜ | å…³é”®å†…å®¹ |
|------|------|---------|
| **6.1** | Creating | éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ |
| **6.2** | Connecting | SDKã€Runsã€Threadsã€Store API |
| **6.3** | Double Texting | å¹¶å‘è¯·æ±‚å¤„ç†ç­–ç•¥ |
| **6.4** | Assistants | é…ç½®åŒ–å’Œç‰ˆæœ¬æ§åˆ¶ |

ä½ ç°åœ¨æŒæ¡äº†ï¼š
- âœ… å¦‚ä½•éƒ¨ç½² LangGraph åº”ç”¨
- âœ… å¦‚ä½•ä½¿ç”¨ API å’Œ SDK
- âœ… å¦‚ä½•å¤„ç†ç”Ÿäº§ç¯å¢ƒçš„å¹¶å‘é—®é¢˜
- âœ… å¦‚ä½•åˆ›å»ºå’Œç®¡ç†å¤šä¸ª assistants

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0
**æœ€åæ›´æ–°**ï¼š2024-11-05
**ä½œè€…**ï¼šAI Assistant
**åŸºäº**ï¼šLangChain Academy Module-6 Lesson 6.4

æ­å–œä½ å®Œæˆäº†æ•´ä¸ª Module-6ï¼ä½ ç°åœ¨å·²ç»æŒæ¡äº† LangGraph çš„ç”Ÿäº§éƒ¨ç½²å…¨æµç¨‹ã€‚ğŸ‰ğŸŠ
